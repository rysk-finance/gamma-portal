{"version":3,"sources":["../node_modules/qr.js/lib/ErrorCorrectLevel.js","../node_modules/warning/warning.js","../node_modules/exenv/index.js","../node_modules/react-lifecycles-compat/react-lifecycles-compat.es.js","../node_modules/qr.js/lib/QRCode.js","../node_modules/qr.js/lib/mode.js","../node_modules/qr.js/lib/Polynomial.js","../node_modules/qr.js/lib/math.js","../node_modules/sdp/sdp.js","../node_modules/webrtc-adapter/src/js/utils.js","../node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","../node_modules/webrtc-adapter/src/js/chrome/getdisplaymedia.js","../node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","../node_modules/webrtc-adapter/src/js/edge/getusermedia.js","../node_modules/webrtc-adapter/src/js/edge/getdisplaymedia.js","../node_modules/webrtc-adapter/src/js/edge/edge_shim.js","../node_modules/webrtc-adapter/src/js/edge/filtericeservers.js","../node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","../node_modules/webrtc-adapter/src/js/firefox/getdisplaymedia.js","../node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","../node_modules/webrtc-adapter/src/js/safari/safari_shim.js","../node_modules/webrtc-adapter/src/js/common_shim.js","../node_modules/webrtc-adapter/src/js/adapter_core.js","../node_modules/webrtc-adapter/src/js/adapter_factory.js","../node_modules/qr.js/lib/8BitByte.js","../node_modules/qr.js/lib/RSBlock.js","../node_modules/qr.js/lib/BitBuffer.js","../node_modules/qr.js/lib/util.js","../node_modules/rtcpeerconnection-shim/rtcpeerconnection.js"],"names":["module","exports","L","M","Q","H","warning","canUseDOM","window","document","createElement","ExecutionEnvironment","canUseWorkers","Worker","canUseEventListeners","addEventListener","attachEvent","canUseViewport","screen","define","componentWillMount","state","this","constructor","getDerivedStateFromProps","props","undefined","setState","componentWillReceiveProps","nextProps","prevState","bind","componentWillUpdate","nextState","prevProps","__reactInternalSnapshotFlag","__reactInternalSnapshot","getSnapshotBeforeUpdate","polyfill","Component","prototype","isReactComponent","Error","foundWillMountName","foundWillReceivePropsName","foundWillUpdateName","UNSAFE_componentWillMount","UNSAFE_componentWillReceiveProps","UNSAFE_componentWillUpdate","componentName","displayName","name","newApiName","componentDidUpdate","maybeSnapshot","snapshot","call","__suppressDeprecationWarning","BitByte","require","RSBlock","BitBuffer","util","Polynomial","QRCode","typeNumber","errorCorrectLevel","modules","moduleCount","dataCache","dataList","proto","addData","data","newData","push","isDark","row","col","getModuleCount","make","rsBlocks","getRSBlocks","buffer","totalDataCount","i","length","dataCount","put","mode","getLength","getLengthInBits","write","makeImpl","getBestMaskPattern","test","maskPattern","Array","setupPositionProbePattern","setupPositionAdjustPattern","setupTimingPattern","setupTypeInfo","setupTypeNumber","createData","mapData","r","c","minLostPoint","pattern","lostPoint","getLostPoint","createMovieClip","target_mc","instance_name","depth","qr_mc","createEmptyMovieClip","y","x","beginFill","moveTo","lineTo","endFill","pos","getPatternPosition","j","bits","getBCHTypeNumber","mod","Math","floor","getBCHTypeInfo","inc","bitIndex","byteIndex","dark","getMask","PAD0","PAD1","putBit","createBytes","offset","maxDcCount","maxEcCount","dcdata","ecdata","dcCount","ecCount","totalCount","max","rsPoly","getErrorCorrectPolynomial","modPoly","modIndex","get","totalCodeCount","index","MODE_NUMBER","MODE_ALPHA_NUM","MODE_8BIT_BYTE","MODE_KANJI","math","QRPolynomial","num","shift","multiply","e","gexp","glog","ratio","QRMath","n","LOG_TABLE","EXP_TABLE","SDPUtils","random","toString","substr","localCName","generateIdentifier","splitLines","blob","trim","split","map","line","splitSections","part","getDescription","sections","getMediaSections","matchPrefix","prefix","filter","indexOf","parseCandidate","parts","candidate","foundation","substring","component","parseInt","protocol","toLowerCase","priority","ip","address","port","type","relatedAddress","relatedPort","tcpType","ufrag","usernameFragment","writeCandidate","sdp","toUpperCase","join","parseIceOptions","parseRtpMap","parsed","payloadType","clockRate","channels","numChannels","writeRtpMap","codec","pt","preferredPayloadType","parseExtmap","id","direction","uri","writeExtmap","headerExtension","preferredId","parseFmtp","kv","writeFmtp","parameters","Object","keys","params","forEach","param","parseRtcpFb","parameter","writeRtcpFb","lines","rtcpFeedback","fb","parseSsrcMedia","sp","ssrc","colon","attribute","value","parseSsrcGroup","semantics","ssrcs","getMid","mediaSection","mid","parseFingerprint","algorithm","getDtlsParameters","sessionpart","role","fingerprints","writeDtlsParameters","setupType","fp","parseCryptoLine","tag","cryptoSuite","keyParams","sessionParams","slice","writeCryptoLine","writeCryptoKeyParams","parseCryptoKeyParams","keyMethod","keySalt","lifeTime","mkiValue","mkiLength","getCryptoParameters","getIceParameters","pwd","password","writeIceParameters","parseRtpParameters","description","codecs","headerExtensions","fecMechanisms","rtcp","mline","rtpmapline","fmtps","writeRtpDescription","kind","caps","maxptime","extension","parseRtpEncodingParameters","secondarySsrc","encodingParameters","hasRed","hasUlpfec","primarySsrc","flows","apt","encParam","codecPayloadType","rtx","JSON","parse","stringify","fec","mechanism","bandwidth","maxBitrate","parseRtcpParameters","rtcpParameters","remoteSsrc","obj","cname","rsize","reducedSize","compound","mux","parseMsid","spec","stream","track","planB","msidParts","parseSctpDescription","maxMessageSize","parseMLine","maxSizeLine","isNaN","sctpPort","fmt","writeSctpDescription","media","sctp","output","generateSessionId","writeSessionBoilerplate","sessId","sessVer","sessUser","version","writeMediaSection","transceiver","iceGatherer","getLocalParameters","dtlsTransport","rtpSender","rtpReceiver","msid","sendEncodingParameters","getDirection","getKind","isRejected","parseOLine","username","sessionId","sessionVersion","netType","addressType","isValidSDP","charAt","logDisabled_","deprecationWarnings_","extractVersion","uastring","expr","match","wrapPeerConnectionEvent","eventNameToWrap","wrapper","RTCPeerConnection","nativeAddEventListener","nativeEventName","cb","apply","arguments","wrappedCallback","modifiedEvent","handleEvent","_eventMap","Map","set","nativeRemoveEventListener","removeEventListener","has","unwrappedCb","delete","size","defineProperty","enumerable","configurable","disableLog","bool","disableWarnings","log","console","deprecated","oldMethod","newMethod","warn","detectBrowser","result","browser","navigator","mozGetUserMedia","userAgent","webkitGetUserMedia","isSecureContext","webkitRTCPeerConnection","RTCIceGatherer","mediaDevices","supportsUnifiedPlan","RTCRtpTransceiver","isObject","val","compactObject","reduce","accumulator","key","isObj","isEmptyObject","assign","filterStats","outbound","streamStatsType","filteredResult","trackStats","trackIdentifier","trackStat","stats","trackId","walkStats","base","resultSet","endsWith","logging","utils","shimGetUserMedia","browserDetails","constraintsToChrome_","mandatory","optional","cc","ideal","exact","min","oldname_","oc","mix","advanced","concat","shimConstraints_","constraints","func","audio","remap","a","b","video","face","facingMode","matches","getSupportedFacingModeLies","getSupportedConstraints","enumerateDevices","then","devices","dev","d","find","some","label","includes","deviceId","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","message","constraint","constraintName","getUserMedia","onSuccess","onError","origGetUserMedia","cs","getAudioTracks","getVideoTracks","getTracks","stop","DOMException","Promise","reject","shimGetDisplayMedia","getSourceId","getDisplayMedia","sourceId","widthSpecified","width","heightSpecified","height","frameRateSpecified","frameRate","chromeMediaSource","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","error","shimMediaStream","MediaStream","webkitMediaStream","shimOnTrack","_ontrack","f","origSetRemoteDescription","setRemoteDescription","_ontrackpoly","te","receiver","getReceivers","event","Event","streams","dispatchEvent","shimGetSendersWithDtmf","shimSenderWithDtmf","pc","_dtmf","createDTMFSender","_pc","getSenders","_senders","origAddTrack","addTrack","sender","origRemoveTrack","removeTrack","idx","splice","origAddStream","addStream","origRemoveStream","removeStream","s","RTCRtpSender","origGetSenders","senders","shimGetStats","origGetStats","getStats","selector","onSucc","onErr","fixChromeStats_","response","standardReport","report","standardStats","timestamp","localcandidate","remotecandidate","names","stat","makeMapStats","successCallbackWrapper_","resolve","shimSenderReceiverGetStats","RTCRtpReceiver","origGetReceivers","receivers","srcElement","MediaStreamTrack","err","shimAddTrackRemoveTrackWithNative","getLocalStreams","_shimmedLocalStreams","streamId","existingSenders","newSenders","newSender","shimAddTrackRemoveTrack","origGetLocalStreams","nativeStreams","_reverseStreams","_streams","newStream","signalingState","t","alreadyExists","oldStream","method","nativeMethod","methodObj","args","isLegacyCall","desc","replaceInternalStreamId","origSetLocalDescription","setLocalDescription","replaceExternalStreamId","origLocalDescription","getOwnPropertyDescriptor","streamid","internalId","externalStream","internalStream","replace","RegExp","RTCSessionDescription","shimPeerConnection","RTCIceCandidate","fixNegotiationNeeded","target","getConfiguration","sdpSemantics","catch","origMSTEnabled","ev","enabled","RTCDtmfSender","RTCDTMFSender","RTCPeerConnectionShim","shimRTCPeerConnection","config","iceServers","edgeVersion","hasTurn","server","urls","url","isString","validTurn","startsWith","filterIceServers","shimReplaceTrack","replaceTrack","setTrack","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","preferredMediaSource","code","mediaSource","RTCTrackEvent","mozRTCPeerConnection","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","shimSenderGetStats","shimReceiverGetStats","shimRemoveStream","shimRTCDataChannel","DataChannel","RTCDataChannel","shimAddTransceiver","origAddTransceiver","addTransceiver","setParametersPromises","initParameters","shouldPerformCheck","sendEncodings","encodingParam","rid","TypeError","parseFloat","scaleResolutionDownBy","RangeError","maxFramerate","getParameters","encodings","setParameters","shimGetParameters","origGetParameters","shimCreateOffer","origCreateOffer","createOffer","all","finally","shimCreateAnswer","origCreateAnswer","createAnswer","shimLocalStreamsAPI","_localStreams","_addTrack","tracks","shimRemoteStreamsAPI","getRemoteStreams","_remoteStreams","_onaddstream","_onaddstreampoly","shimCallbacksAPI","addIceCandidate","successCallback","failureCallback","options","promise","withCallback","_getUserMedia","shimConstraints","errcb","shimRTCIceServerUrls","OrigPeerConnection","pcConfig","pcConstraints","newIceServers","hasOwnProperty","generateCertificate","shimTrackEventTransceiver","shimCreateOfferLegacy","offerOptions","offerToReceiveAudio","audioTransceiver","getTransceivers","setDirection","offerToReceiveVideo","videoTransceiver","shimAudioContext","AudioContext","webkitAudioContext","shimRTCIceCandidate","NativeRTCIceCandidate","nativeCandidate","parsedCandidate","augmentedCandidate","toJSON","sdpMid","sdpMLineIndex","writable","shimMaxMessageSize","_sctp","sctpInDescription","mLine","getRemoteFirefoxVersion","getCanSendMaxMessageSize","remoteIsFirefox","canSendMaxMessageSize","getMaxMessageSize","isFirefox","canSendMMS","remoteMMS","Number","POSITIVE_INFINITY","shimSendThrowTypeError","origCreateDataChannel","createDataChannel","dataChannel","wrapDcSend","channel","dc","origDataChannelSend","send","byteLength","readyState","shimConnectionState","completed","checking","iceConnectionState","_onconnectionstatechange","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","newEvent","removeExtmapAllowMixed","nativeSRD","shimAddIceCandidateNullOrEmpty","nativeAddIceCandidate","adapter","shimChrome","shimFirefox","shimEdge","shimSafari","commonShim","chromeShim","browserShim","firefoxShim","edgeShim","safariShim","adapterFactory","QR8bitByte","charCodeAt","ECL","QRRSBlock","RS_BLOCK_TABLE","rsBlock","getRsBlockTable","list","count","QRBitBuffer","bufIndex","bit","Mode","QRMaskPattern","QRUtil","PATTERN_POSITION_TABLE","G15","G18","G15_MASK","getBCHDigit","digit","errorCorrectLength","qrCode","sameCount","darkCount","abs","dtlsRole","_initialTrackId","getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","findCodecByPayloadType","rtxCapabilityMatches","lRtx","rRtx","lCodecs","rCodecs","lCodec","rCodec","lHeaderExtension","rHeaderExtension","isActionAllowedInSignalingState","action","offer","answer","maybeAddCandidate","iceTransport","alreadyAdded","getRemoteCandidates","remoteCandidate","addRemoteCandidate","makeError","NotSupportedError","InvalidAccessError","OperationError","addTrackToStreamAndFireEvent","MediaStreamTrackEvent","fireAddTrack","trackEvent","setTimeout","_dispatchEvent","_eventTarget","createDocumentFragment","canTrickleIceCandidates","needNegotiation","localStreams","remoteStreams","_localDescription","_remoteDescription","iceGatheringState","usingBundle","bundlePolicy","rtcpMuxPolicy","iceTransportPolicy","_iceGatherers","iceCandidatePoolSize","gatherPolicy","_config","transceivers","_sdpSessionId","_sdpSessionVersion","_dtlsRole","_isClosed","onicecandidate","onaddstream","ontrack","onremovestream","onsignalingstatechange","oniceconnectionstatechange","onconnectionstatechange","onicegatheringstatechange","onnegotiationneeded","ondatachannel","_emitGatheringStateChange","_createTransceiver","doNotAdd","hasBundleTransport","recvEncodingParameters","associatedRemoteMediaStreams","wantReceive","transports","_createIceAndDtlsTransports","_maybeFireNegotiationNeeded","clonedStream","clone","clonedTrack","_createIceGatherer","bufferedCandidateEvents","bufferCandidates","end","_gather","onlocalcandidate","evt","cand","serializedCandidate","complete","every","RTCIceTransport","onicestatechange","_updateIceConnectionState","_updateConnectionState","RTCDtlsTransport","ondtlsstatechange","onerror","_disposeIceAndDtlsTransports","_transceive","recv","p","receive","isIceLite","rejected","remoteIceParameters","remoteDtlsParameters","start","_updateSignalingState","receiverList","iceOptions","remoteMsid","isComplete","cands","setTransport","setRemoteCandidates","default","getCapabilities","isNewTrack","nativeTrack","removeTrackFromStreamAndFireEvent","sid","item","close","newState","states","closed","connected","disconnected","failed","new","connecting","numAudioTracks","numVideoTracks","remoteCodec","hdrExt","rHdrExt","getLocalCandidates","mediaSectionsInOffer","localTrack","candidateString","senderOrReceiver","promises","allStats","results","ortcObjectName","nativeGetstats","nativeStats","mapStats","methods"],"mappings":"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","file":"static/js/13.b2780a59.chunk.js","sourcesContent":["module.exports = {\n\tL : 1,\n\tM : 0,\n\tQ : 3,\n\tH : 2\n};\n\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n/**\n * Similar to invariant but only logs a warning if the condition is not met.\n * This can be used to log issues in development environments in critical\n * paths. Removing the logging code for production environments will keep the\n * same logic and follow the same code paths.\n */\n\nvar __DEV__ = process.env.NODE_ENV !== 'production';\n\nvar warning = function() {};\n\nif (__DEV__) {\n  var printWarning = function printWarning(format, args) {\n    var len = arguments.length;\n    args = new Array(len > 1 ? len - 1 : 0);\n    for (var key = 1; key < len; key++) {\n      args[key - 1] = arguments[key];\n    }\n    var argIndex = 0;\n    var message = 'Warning: ' +\n      format.replace(/%s/g, function() {\n        return args[argIndex++];\n      });\n    if (typeof console !== 'undefined') {\n      console.error(message);\n    }\n    try {\n      // --- Welcome to debugging React ---\n      // This error was thrown as a convenience so that you can use this stack\n      // to find the callsite that caused this warning to fire.\n      throw new Error(message);\n    } catch (x) {}\n  }\n\n  warning = function(condition, format, args) {\n    var len = arguments.length;\n    args = new Array(len > 2 ? len - 2 : 0);\n    for (var key = 2; key < len; key++) {\n      args[key - 2] = arguments[key];\n    }\n    if (format === undefined) {\n      throw new Error(\n          '`warning(condition, format, ...args)` requires a warning ' +\n          'message argument'\n      );\n    }\n    if (!condition) {\n      printWarning.apply(null, [format].concat(args));\n    }\n  };\n}\n\nmodule.exports = warning;\n","/*!\n  Copyright (c) 2015 Jed Watson.\n  Based on code that is Copyright 2013-2015, Facebook, Inc.\n  All rights reserved.\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar canUseDOM = !!(\n\t\ttypeof window !== 'undefined' &&\n\t\twindow.document &&\n\t\twindow.document.createElement\n\t);\n\n\tvar ExecutionEnvironment = {\n\n\t\tcanUseDOM: canUseDOM,\n\n\t\tcanUseWorkers: typeof Worker !== 'undefined',\n\n\t\tcanUseEventListeners:\n\t\t\tcanUseDOM && !!(window.addEventListener || window.attachEvent),\n\n\t\tcanUseViewport: canUseDOM && !!window.screen\n\n\t};\n\n\tif (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\tdefine(function () {\n\t\t\treturn ExecutionEnvironment;\n\t\t});\n\t} else if (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = ExecutionEnvironment;\n\t} else {\n\t\twindow.ExecutionEnvironment = ExecutionEnvironment;\n\t}\n\n}());\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nfunction componentWillMount() {\n  // Call this.constructor.gDSFP to support sub-classes.\n  var state = this.constructor.getDerivedStateFromProps(this.props, this.state);\n  if (state !== null && state !== undefined) {\n    this.setState(state);\n  }\n}\n\nfunction componentWillReceiveProps(nextProps) {\n  // Call this.constructor.gDSFP to support sub-classes.\n  // Use the setState() updater to ensure state isn't stale in certain edge cases.\n  function updater(prevState) {\n    var state = this.constructor.getDerivedStateFromProps(nextProps, prevState);\n    return state !== null && state !== undefined ? state : null;\n  }\n  // Binding \"this\" is important for shallow renderer support.\n  this.setState(updater.bind(this));\n}\n\nfunction componentWillUpdate(nextProps, nextState) {\n  try {\n    var prevProps = this.props;\n    var prevState = this.state;\n    this.props = nextProps;\n    this.state = nextState;\n    this.__reactInternalSnapshotFlag = true;\n    this.__reactInternalSnapshot = this.getSnapshotBeforeUpdate(\n      prevProps,\n      prevState\n    );\n  } finally {\n    this.props = prevProps;\n    this.state = prevState;\n  }\n}\n\n// React may warn about cWM/cWRP/cWU methods being deprecated.\n// Add a flag to suppress these warnings for this special case.\ncomponentWillMount.__suppressDeprecationWarning = true;\ncomponentWillReceiveProps.__suppressDeprecationWarning = true;\ncomponentWillUpdate.__suppressDeprecationWarning = true;\n\nfunction polyfill(Component) {\n  var prototype = Component.prototype;\n\n  if (!prototype || !prototype.isReactComponent) {\n    throw new Error('Can only polyfill class components');\n  }\n\n  if (\n    typeof Component.getDerivedStateFromProps !== 'function' &&\n    typeof prototype.getSnapshotBeforeUpdate !== 'function'\n  ) {\n    return Component;\n  }\n\n  // If new component APIs are defined, \"unsafe\" lifecycles won't be called.\n  // Error if any of these lifecycles are present,\n  // Because they would work differently between older and newer (16.3+) versions of React.\n  var foundWillMountName = null;\n  var foundWillReceivePropsName = null;\n  var foundWillUpdateName = null;\n  if (typeof prototype.componentWillMount === 'function') {\n    foundWillMountName = 'componentWillMount';\n  } else if (typeof prototype.UNSAFE_componentWillMount === 'function') {\n    foundWillMountName = 'UNSAFE_componentWillMount';\n  }\n  if (typeof prototype.componentWillReceiveProps === 'function') {\n    foundWillReceivePropsName = 'componentWillReceiveProps';\n  } else if (typeof prototype.UNSAFE_componentWillReceiveProps === 'function') {\n    foundWillReceivePropsName = 'UNSAFE_componentWillReceiveProps';\n  }\n  if (typeof prototype.componentWillUpdate === 'function') {\n    foundWillUpdateName = 'componentWillUpdate';\n  } else if (typeof prototype.UNSAFE_componentWillUpdate === 'function') {\n    foundWillUpdateName = 'UNSAFE_componentWillUpdate';\n  }\n  if (\n    foundWillMountName !== null ||\n    foundWillReceivePropsName !== null ||\n    foundWillUpdateName !== null\n  ) {\n    var componentName = Component.displayName || Component.name;\n    var newApiName =\n      typeof Component.getDerivedStateFromProps === 'function'\n        ? 'getDerivedStateFromProps()'\n        : 'getSnapshotBeforeUpdate()';\n\n    throw Error(\n      'Unsafe legacy lifecycles will not be called for components using new component APIs.\\n\\n' +\n        componentName +\n        ' uses ' +\n        newApiName +\n        ' but also contains the following legacy lifecycles:' +\n        (foundWillMountName !== null ? '\\n  ' + foundWillMountName : '') +\n        (foundWillReceivePropsName !== null\n          ? '\\n  ' + foundWillReceivePropsName\n          : '') +\n        (foundWillUpdateName !== null ? '\\n  ' + foundWillUpdateName : '') +\n        '\\n\\nThe above lifecycles should be removed. Learn more about this warning here:\\n' +\n        'https://fb.me/react-async-component-lifecycle-hooks'\n    );\n  }\n\n  // React <= 16.2 does not support static getDerivedStateFromProps.\n  // As a workaround, use cWM and cWRP to invoke the new static lifecycle.\n  // Newer versions of React will ignore these lifecycles if gDSFP exists.\n  if (typeof Component.getDerivedStateFromProps === 'function') {\n    prototype.componentWillMount = componentWillMount;\n    prototype.componentWillReceiveProps = componentWillReceiveProps;\n  }\n\n  // React <= 16.2 does not support getSnapshotBeforeUpdate.\n  // As a workaround, use cWU to invoke the new lifecycle.\n  // Newer versions of React will ignore that lifecycle if gSBU exists.\n  if (typeof prototype.getSnapshotBeforeUpdate === 'function') {\n    if (typeof prototype.componentDidUpdate !== 'function') {\n      throw new Error(\n        'Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype'\n      );\n    }\n\n    prototype.componentWillUpdate = componentWillUpdate;\n\n    var componentDidUpdate = prototype.componentDidUpdate;\n\n    prototype.componentDidUpdate = function componentDidUpdatePolyfill(\n      prevProps,\n      prevState,\n      maybeSnapshot\n    ) {\n      // 16.3+ will not execute our will-update method;\n      // It will pass a snapshot value to did-update though.\n      // Older versions will require our polyfilled will-update value.\n      // We need to handle both cases, but can't just check for the presence of \"maybeSnapshot\",\n      // Because for <= 15.x versions this might be a \"prevContext\" object.\n      // We also can't just check \"__reactInternalSnapshot\",\n      // Because get-snapshot might return a falsy value.\n      // So check for the explicit __reactInternalSnapshotFlag flag to determine behavior.\n      var snapshot = this.__reactInternalSnapshotFlag\n        ? this.__reactInternalSnapshot\n        : maybeSnapshot;\n\n      componentDidUpdate.call(this, prevProps, prevState, snapshot);\n    };\n  }\n\n  return Component;\n}\n\nexport { polyfill };\n","var BitByte = require('./8BitByte');\nvar RSBlock = require('./RSBlock');\nvar BitBuffer = require('./BitBuffer');\nvar util = require('./util');\nvar Polynomial = require('./Polynomial');\n\nfunction QRCode(typeNumber, errorCorrectLevel) {\n\tthis.typeNumber = typeNumber;\n\tthis.errorCorrectLevel = errorCorrectLevel;\n\tthis.modules = null;\n\tthis.moduleCount = 0;\n\tthis.dataCache = null;\n\tthis.dataList = [];\n}\n\n// for client side minification\nvar proto = QRCode.prototype;\n\nproto.addData = function(data) {\n\tvar newData = new BitByte(data);\n\tthis.dataList.push(newData);\n\tthis.dataCache = null;\n};\n\nproto.isDark = function(row, col) {\n\tif (row < 0 || this.moduleCount <= row || col < 0 || this.moduleCount <= col) {\n\t\tthrow new Error(row + \",\" + col);\n\t}\n\treturn this.modules[row][col];\n};\n\nproto.getModuleCount = function() {\n\treturn this.moduleCount;\n};\n\nproto.make = function() {\n\t// Calculate automatically typeNumber if provided is < 1\n\tif (this.typeNumber < 1 ){\n\t\tvar typeNumber = 1;\n\t\tfor (typeNumber = 1; typeNumber < 40; typeNumber++) {\n\t\t\tvar rsBlocks = RSBlock.getRSBlocks(typeNumber, this.errorCorrectLevel);\n\n\t\t\tvar buffer = new BitBuffer();\n\t\t\tvar totalDataCount = 0;\n\t\t\tfor (var i = 0; i < rsBlocks.length; i++) {\n\t\t\t\ttotalDataCount += rsBlocks[i].dataCount;\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < this.dataList.length; i++) {\n\t\t\t\tvar data = this.dataList[i];\n\t\t\t\tbuffer.put(data.mode, 4);\n\t\t\t\tbuffer.put(data.getLength(), util.getLengthInBits(data.mode, typeNumber) );\n\t\t\t\tdata.write(buffer);\n\t\t\t}\n\t\t\tif (buffer.getLengthInBits() <= totalDataCount * 8)\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.typeNumber = typeNumber;\n\t}\n\tthis.makeImpl(false, this.getBestMaskPattern() );\n};\n\nproto.makeImpl = function(test, maskPattern) {\n\t\n\tthis.moduleCount = this.typeNumber * 4 + 17;\n\tthis.modules = new Array(this.moduleCount);\n\t\n\tfor (var row = 0; row < this.moduleCount; row++) {\n\t\t\n\t\tthis.modules[row] = new Array(this.moduleCount);\n\t\t\n\t\tfor (var col = 0; col < this.moduleCount; col++) {\n\t\t\tthis.modules[row][col] = null;//(col + row) % 3;\n\t\t}\n\t}\n\n\tthis.setupPositionProbePattern(0, 0);\n\tthis.setupPositionProbePattern(this.moduleCount - 7, 0);\n\tthis.setupPositionProbePattern(0, this.moduleCount - 7);\n\tthis.setupPositionAdjustPattern();\n\tthis.setupTimingPattern();\n\tthis.setupTypeInfo(test, maskPattern);\n\t\n\tif (this.typeNumber >= 7) {\n\t\tthis.setupTypeNumber(test);\n\t}\n\n\tif (this.dataCache == null) {\n\t\tthis.dataCache = QRCode.createData(this.typeNumber, this.errorCorrectLevel, this.dataList);\n\t}\n\n\tthis.mapData(this.dataCache, maskPattern);\n};\n\nproto.setupPositionProbePattern = function(row, col)  {\n\t\n\tfor (var r = -1; r <= 7; r++) {\n\t\t\n\t\tif (row + r <= -1 || this.moduleCount <= row + r) continue;\n\t\t\n\t\tfor (var c = -1; c <= 7; c++) {\n\t\t\t\n\t\t\tif (col + c <= -1 || this.moduleCount <= col + c) continue;\n\t\t\t\n\t\t\tif ( (0 <= r && r <= 6 && (c == 0 || c == 6) )\n\t\t\t\t\t|| (0 <= c && c <= 6 && (r == 0 || r == 6) )\n\t\t\t\t\t|| (2 <= r && r <= 4 && 2 <= c && c <= 4) ) {\n\t\t\t\tthis.modules[row + r][col + c] = true;\n\t\t\t} else {\n\t\t\t\tthis.modules[row + r][col + c] = false;\n\t\t\t}\n\t\t}\t\t\n\t}\t\t\n};\n\nproto.getBestMaskPattern = function() {\n\n\tvar minLostPoint = 0;\n\tvar pattern = 0;\n\n\tfor (var i = 0; i < 8; i++) {\n\t\t\n\t\tthis.makeImpl(true, i);\n\n\t\tvar lostPoint = util.getLostPoint(this);\n\n\t\tif (i == 0 || minLostPoint >  lostPoint) {\n\t\t\tminLostPoint = lostPoint;\n\t\t\tpattern = i;\n\t\t}\n\t}\n\n\treturn pattern;\n};\n\nproto.createMovieClip = function(target_mc, instance_name, depth) {\n\n\tvar qr_mc = target_mc.createEmptyMovieClip(instance_name, depth);\n\tvar cs = 1;\n\n\tthis.make();\n\n\tfor (var row = 0; row < this.modules.length; row++) {\n\t\t\n\t\tvar y = row * cs;\n\t\t\n\t\tfor (var col = 0; col < this.modules[row].length; col++) {\n\n\t\t\tvar x = col * cs;\n\t\t\tvar dark = this.modules[row][col];\n\t\t\n\t\t\tif (dark) {\n\t\t\t\tqr_mc.beginFill(0, 100);\n\t\t\t\tqr_mc.moveTo(x, y);\n\t\t\t\tqr_mc.lineTo(x + cs, y);\n\t\t\t\tqr_mc.lineTo(x + cs, y + cs);\n\t\t\t\tqr_mc.lineTo(x, y + cs);\n\t\t\t\tqr_mc.endFill();\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn qr_mc;\n};\n\nproto.setupTimingPattern = function() {\n\t\n\tfor (var r = 8; r < this.moduleCount - 8; r++) {\n\t\tif (this.modules[r][6] != null) {\n\t\t\tcontinue;\n\t\t}\n\t\tthis.modules[r][6] = (r % 2 == 0);\n\t}\n\n\tfor (var c = 8; c < this.moduleCount - 8; c++) {\n\t\tif (this.modules[6][c] != null) {\n\t\t\tcontinue;\n\t\t}\n\t\tthis.modules[6][c] = (c % 2 == 0);\n\t}\n};\n\nproto.setupPositionAdjustPattern = function() {\n\n\tvar pos = util.getPatternPosition(this.typeNumber);\n\t\n\tfor (var i = 0; i < pos.length; i++) {\n\t\n\t\tfor (var j = 0; j < pos.length; j++) {\n\t\t\n\t\t\tvar row = pos[i];\n\t\t\tvar col = pos[j];\n\t\t\t\n\t\t\tif (this.modules[row][col] != null) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tfor (var r = -2; r <= 2; r++) {\n\t\t\t\n\t\t\t\tfor (var c = -2; c <= 2; c++) {\n\t\t\t\t\n\t\t\t\t\tif (r == -2 || r == 2 || c == -2 || c == 2\n\t\t\t\t\t\t\t|| (r == 0 && c == 0) ) {\n\t\t\t\t\t\tthis.modules[row + r][col + c] = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.modules[row + r][col + c] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\nproto.setupTypeNumber = function(test) {\n\n\tvar bits = util.getBCHTypeNumber(this.typeNumber);\n\n\tfor (var i = 0; i < 18; i++) {\n\t\tvar mod = (!test && ( (bits >> i) & 1) == 1);\n\t\tthis.modules[Math.floor(i / 3)][i % 3 + this.moduleCount - 8 - 3] = mod;\n\t}\n\n\tfor (var i = 0; i < 18; i++) {\n\t\tvar mod = (!test && ( (bits >> i) & 1) == 1);\n\t\tthis.modules[i % 3 + this.moduleCount - 8 - 3][Math.floor(i / 3)] = mod;\n\t}\n};\n\nproto.setupTypeInfo = function(test, maskPattern) {\n\n\tvar data = (this.errorCorrectLevel << 3) | maskPattern;\n\tvar bits = util.getBCHTypeInfo(data);\n\n\t// vertical\t\t\n\tfor (var i = 0; i < 15; i++) {\n\n\t\tvar mod = (!test && ( (bits >> i) & 1) == 1);\n\n\t\tif (i < 6) {\n\t\t\tthis.modules[i][8] = mod;\n\t\t} else if (i < 8) {\n\t\t\tthis.modules[i + 1][8] = mod;\n\t\t} else {\n\t\t\tthis.modules[this.moduleCount - 15 + i][8] = mod;\n\t\t}\n\t}\n\n\t// horizontal\n\tfor (var i = 0; i < 15; i++) {\n\n\t\tvar mod = (!test && ( (bits >> i) & 1) == 1);\n\t\t\n\t\tif (i < 8) {\n\t\t\tthis.modules[8][this.moduleCount - i - 1] = mod;\n\t\t} else if (i < 9) {\n\t\t\tthis.modules[8][15 - i - 1 + 1] = mod;\n\t\t} else {\n\t\t\tthis.modules[8][15 - i - 1] = mod;\n\t\t}\n\t}\n\n\t// fixed module\n\tthis.modules[this.moduleCount - 8][8] = (!test);\n};\n\nproto.mapData = function(data, maskPattern) {\n\t\n\tvar inc = -1;\n\tvar row = this.moduleCount - 1;\n\tvar bitIndex = 7;\n\tvar byteIndex = 0;\n\t\n\tfor (var col = this.moduleCount - 1; col > 0; col -= 2) {\n\n\t\tif (col == 6) col--;\n\n\t\twhile (true) {\n\n\t\t\tfor (var c = 0; c < 2; c++) {\n\t\t\t\t\n\t\t\t\tif (this.modules[row][col - c] == null) {\n\t\t\t\t\t\n\t\t\t\t\tvar dark = false;\n\n\t\t\t\t\tif (byteIndex < data.length) {\n\t\t\t\t\t\tdark = ( ( (data[byteIndex] >>> bitIndex) & 1) == 1);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar mask = util.getMask(maskPattern, row, col - c);\n\n\t\t\t\t\tif (mask) {\n\t\t\t\t\t\tdark = !dark;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis.modules[row][col - c] = dark;\n\t\t\t\t\tbitIndex--;\n\n\t\t\t\t\tif (bitIndex == -1) {\n\t\t\t\t\t\tbyteIndex++;\n\t\t\t\t\t\tbitIndex = 7;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\trow += inc;\n\n\t\t\tif (row < 0 || this.moduleCount <= row) {\n\t\t\t\trow -= inc;\n\t\t\t\tinc = -inc;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n};\n\nQRCode.PAD0 = 0xEC;\nQRCode.PAD1 = 0x11;\n\nQRCode.createData = function(typeNumber, errorCorrectLevel, dataList) {\n\t\n\tvar rsBlocks = RSBlock.getRSBlocks(typeNumber, errorCorrectLevel);\n\t\n\tvar buffer = new BitBuffer();\n\t\n\tfor (var i = 0; i < dataList.length; i++) {\n\t\tvar data = dataList[i];\n\t\tbuffer.put(data.mode, 4);\n\t\tbuffer.put(data.getLength(), util.getLengthInBits(data.mode, typeNumber) );\n\t\tdata.write(buffer);\n\t}\n\n\t// calc num max data.\n\tvar totalDataCount = 0;\n\tfor (var i = 0; i < rsBlocks.length; i++) {\n\t\ttotalDataCount += rsBlocks[i].dataCount;\n\t}\n\n\tif (buffer.getLengthInBits() > totalDataCount * 8) {\n\t\tthrow new Error(\"code length overflow. (\"\n\t\t\t+ buffer.getLengthInBits()\n\t\t\t+ \">\"\n\t\t\t+  totalDataCount * 8\n\t\t\t+ \")\");\n\t}\n\n\t// end code\n\tif (buffer.getLengthInBits() + 4 <= totalDataCount * 8) {\n\t\tbuffer.put(0, 4);\n\t}\n\n\t// padding\n\twhile (buffer.getLengthInBits() % 8 != 0) {\n\t\tbuffer.putBit(false);\n\t}\n\n\t// padding\n\twhile (true) {\n\t\t\n\t\tif (buffer.getLengthInBits() >= totalDataCount * 8) {\n\t\t\tbreak;\n\t\t}\n\t\tbuffer.put(QRCode.PAD0, 8);\n\t\t\n\t\tif (buffer.getLengthInBits() >= totalDataCount * 8) {\n\t\t\tbreak;\n\t\t}\n\t\tbuffer.put(QRCode.PAD1, 8);\n\t}\n\n\treturn QRCode.createBytes(buffer, rsBlocks);\n};\n\nQRCode.createBytes = function(buffer, rsBlocks) {\n\n\tvar offset = 0;\n\t\n\tvar maxDcCount = 0;\n\tvar maxEcCount = 0;\n\t\n\tvar dcdata = new Array(rsBlocks.length);\n\tvar ecdata = new Array(rsBlocks.length);\n\t\n\tfor (var r = 0; r < rsBlocks.length; r++) {\n\n\t\tvar dcCount = rsBlocks[r].dataCount;\n\t\tvar ecCount = rsBlocks[r].totalCount - dcCount;\n\n\t\tmaxDcCount = Math.max(maxDcCount, dcCount);\n\t\tmaxEcCount = Math.max(maxEcCount, ecCount);\n\t\t\n\t\tdcdata[r] = new Array(dcCount);\n\t\t\n\t\tfor (var i = 0; i < dcdata[r].length; i++) {\n\t\t\tdcdata[r][i] = 0xff & buffer.buffer[i + offset];\n\t\t}\n\t\toffset += dcCount;\n\t\t\n\t\tvar rsPoly = util.getErrorCorrectPolynomial(ecCount);\n\t\tvar rawPoly = new Polynomial(dcdata[r], rsPoly.getLength() - 1);\n\n\t\tvar modPoly = rawPoly.mod(rsPoly);\n\t\tecdata[r] = new Array(rsPoly.getLength() - 1);\n\t\tfor (var i = 0; i < ecdata[r].length; i++) {\n            var modIndex = i + modPoly.getLength() - ecdata[r].length;\n\t\t\tecdata[r][i] = (modIndex >= 0)? modPoly.get(modIndex) : 0;\n\t\t}\n\n\t}\n\t\n\tvar totalCodeCount = 0;\n\tfor (var i = 0; i < rsBlocks.length; i++) {\n\t\ttotalCodeCount += rsBlocks[i].totalCount;\n\t}\n\n\tvar data = new Array(totalCodeCount);\n\tvar index = 0;\n\n\tfor (var i = 0; i < maxDcCount; i++) {\n\t\tfor (var r = 0; r < rsBlocks.length; r++) {\n\t\t\tif (i < dcdata[r].length) {\n\t\t\t\tdata[index++] = dcdata[r][i];\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (var i = 0; i < maxEcCount; i++) {\n\t\tfor (var r = 0; r < rsBlocks.length; r++) {\n\t\t\tif (i < ecdata[r].length) {\n\t\t\t\tdata[index++] = ecdata[r][i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn data;\n};\n\nmodule.exports = QRCode;\n\n","module.exports = {\n\tMODE_NUMBER :\t\t1 << 0,\n\tMODE_ALPHA_NUM : \t1 << 1,\n\tMODE_8BIT_BYTE : \t1 << 2,\n\tMODE_KANJI :\t\t1 << 3\n};\n","var math = require('./math');\n\nfunction QRPolynomial(num, shift) {\n\n\tif (num.length == undefined) {\n\t\tthrow new Error(num.length + \"/\" + shift);\n\t}\n\n\tvar offset = 0;\n\n\twhile (offset < num.length && num[offset] == 0) {\n\t\toffset++;\n\t}\n\n\tthis.num = new Array(num.length - offset + shift);\n\tfor (var i = 0; i < num.length - offset; i++) {\n\t\tthis.num[i] = num[i + offset];\n\t}\n}\n\nQRPolynomial.prototype = {\n\n\tget : function(index) {\n\t\treturn this.num[index];\n\t},\n\t\n\tgetLength : function() {\n\t\treturn this.num.length;\n\t},\n\t\n\tmultiply : function(e) {\n\t\n\t\tvar num = new Array(this.getLength() + e.getLength() - 1);\n\t\n\t\tfor (var i = 0; i < this.getLength(); i++) {\n\t\t\tfor (var j = 0; j < e.getLength(); j++) {\n\t\t\t\tnum[i + j] ^= math.gexp(math.glog(this.get(i) ) + math.glog(e.get(j) ) );\n\t\t\t}\n\t\t}\n\t\n\t\treturn new QRPolynomial(num, 0);\n\t},\n\t\n\tmod : function(e) {\n\t\n\t\tif (this.getLength() - e.getLength() < 0) {\n\t\t\treturn this;\n\t\t}\n\t\n\t\tvar ratio = math.glog(this.get(0) ) - math.glog(e.get(0) );\n\t\n\t\tvar num = new Array(this.getLength() );\n\t\t\n\t\tfor (var i = 0; i < this.getLength(); i++) {\n\t\t\tnum[i] = this.get(i);\n\t\t}\n\t\t\n\t\tfor (var i = 0; i < e.getLength(); i++) {\n\t\t\tnum[i] ^= math.gexp(math.glog(e.get(i) ) + ratio);\n\t\t}\n\t\n\t\t// recursive call\n\t\treturn new QRPolynomial(num, 0).mod(e);\n\t}\n};\n\nmodule.exports = QRPolynomial;\n","var QRMath = {\n\n\tglog : function(n) {\n\t\n\t\tif (n < 1) {\n\t\t\tthrow new Error(\"glog(\" + n + \")\");\n\t\t}\n\t\t\n\t\treturn QRMath.LOG_TABLE[n];\n\t},\n\t\n\tgexp : function(n) {\n\t\n\t\twhile (n < 0) {\n\t\t\tn += 255;\n\t\t}\n\t\n\t\twhile (n >= 256) {\n\t\t\tn -= 255;\n\t\t}\n\t\n\t\treturn QRMath.EXP_TABLE[n];\n\t},\n\t\n\tEXP_TABLE : new Array(256),\n\t\n\tLOG_TABLE : new Array(256)\n\n};\n\t\nfor (var i = 0; i < 8; i++) {\n\tQRMath.EXP_TABLE[i] = 1 << i;\n}\nfor (var i = 8; i < 256; i++) {\n\tQRMath.EXP_TABLE[i] = QRMath.EXP_TABLE[i - 4]\n\t\t^ QRMath.EXP_TABLE[i - 5]\n\t\t^ QRMath.EXP_TABLE[i - 6]\n\t\t^ QRMath.EXP_TABLE[i - 8];\n}\nfor (var i = 0; i < 255; i++) {\n\tQRMath.LOG_TABLE[QRMath.EXP_TABLE[i] ] = i;\n}\n\nmodule.exports = QRMath;\n","/* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// returns the session description.\nSDPUtils.getDescription = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parseInt(parts[1], 10),\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compability.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n};\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  var channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? '/' + headerExtension.direction\n        : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      if (codec.parameters[param]) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\nSDPUtils.parseSsrcGroup = function(line) {\n  var parts = line.substr(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(function(ssrc) {\n      return parseInt(ssrc, 10);\n    })\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n};\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n\n// Parses a=crypto lines into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\nSDPUtils.parseCryptoLine = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    tag: parseInt(parts[0], 10),\n    cryptoSuite: parts[1],\n    keyParams: parts[2],\n    sessionParams: parts.slice(3),\n  };\n};\n\nSDPUtils.writeCryptoLine = function(parameters) {\n  return 'a=crypto:' + parameters.tag + ' ' +\n    parameters.cryptoSuite + ' ' +\n    (typeof parameters.keyParams === 'object'\n      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)\n      : parameters.keyParams) +\n    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +\n    '\\r\\n';\n};\n\n// Parses the crypto key parameters into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\nSDPUtils.parseCryptoKeyParams = function(keyParams) {\n  if (keyParams.indexOf('inline:') !== 0) {\n    return null;\n  }\n  var parts = keyParams.substr(7).split('|');\n  return {\n    keyMethod: 'inline',\n    keySalt: parts[0],\n    lifeTime: parts[1],\n    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,\n  };\n};\n\nSDPUtils.writeCryptoKeyParams = function(keyParams) {\n  return keyParams.keyMethod + ':'\n    + keyParams.keySalt +\n    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +\n    (keyParams.mkiValue && keyParams.mkiLength\n      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength\n      : '');\n};\n\n// Extracts all SDES paramters.\nSDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=crypto:');\n  return lines.map(SDPUtils.parseCryptoLine);\n};\n\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-ufrag:')[0];\n  var pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-pwd:')[0];\n  if (!(ufrag && pwd)) {\n    return null;\n  }\n  return {\n    usernameFragment: ufrag.substr(12),\n    password: pwd.substr(10),\n  };\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n      mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n        mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(function(extension) {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(parts) {\n      return parts.attribute === 'cname';\n    });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(function(line) {\n      var parts = line.substr(17).split(' ');\n      return parts.map(function(part) {\n        return parseInt(part, 10);\n      });\n    });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10)\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  // Gets the first SSRC. Note tha with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(obj) {\n      return obj.attribute === 'cname';\n    })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrіbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(msidParts) {\n      return msidParts.attribute === 'msid';\n    });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function(mediaSection) {\n  var mline = SDPUtils.parseMLine(mediaSection);\n  var maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  var maxMessageSize;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substr(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  var sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substr(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize: maxMessageSize\n    };\n  }\n  var sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    var parts = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:')[0]\n      .substr(10)\n      .split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize: maxMessageSize\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function(media, sctp) {\n  var output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctp-port:' + sctp.port + '\\r\\n'\n    ];\n  } else {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n'\n    ];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 21);\n};\n\n// Write boilder plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  var sessionId;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  var user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n    transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n    transceiver.dtlsTransport.getLocalParameters(),\n    type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var parts = lines[0].substr(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' ')\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  var parts = line.substr(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5]\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  var lines = SDPUtils.splitLines(blob);\n  for (var i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nlet logDisabled_ = true;\nlet deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nexport function extractVersion(uastring, expr, pos) {\n  const match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nexport function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  const nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    const wrappedCallback = (e) => {\n      const modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        if (cb.handleEvent) {\n          cb.handleEvent(modifiedEvent);\n        } else {\n          cb(modifiedEvent);\n        }\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    if (!this._eventMap[eventNameToWrap]) {\n      this._eventMap[eventNameToWrap] = new Map();\n    }\n    this._eventMap[eventNameToWrap].set(cb, wrappedCallback);\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  const nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[eventNameToWrap]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    if (!this._eventMap[eventNameToWrap].has(cb)) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    const unwrappedCb = this._eventMap[eventNameToWrap].get(cb);\n    this._eventMap[eventNameToWrap].delete(cb);\n    if (this._eventMap[eventNameToWrap].size === 0) {\n      delete this._eventMap[eventNameToWrap];\n    }\n    if (Object.keys(this._eventMap).length === 0) {\n      delete this._eventMap;\n    }\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\n\nexport function disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return (bool) ? 'adapter.js logging disabled' :\n      'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nexport function disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nexport function log() {\n  if (typeof window === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nexport function deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n      ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nexport function detectBrowser(window) {\n  // Returned result object.\n  const result = {browser: null, version: null};\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  const {navigator} = window;\n\n  if (navigator.mozGetUserMedia) { // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent,\n        /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia ||\n      (window.isSecureContext === false && window.webkitRTCPeerConnection &&\n       !window.RTCIceGatherer)) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n    // more complicated fallback to webkitRTCPeerConnection.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent,\n        /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (navigator.mediaDevices &&\n      navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) { // Edge.\n    result.browser = 'edge';\n    result.version = extractVersion(navigator.userAgent,\n        /Edge\\/(\\d+).(\\d+)$/, 2);\n  } else if (window.RTCPeerConnection &&\n      navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) { // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent,\n        /AppleWebKit\\/(\\d+)\\./, 1);\n    result.supportsUnifiedPlan = window.RTCRtpTransceiver &&\n        'currentDirection' in window.RTCRtpTransceiver.prototype;\n  } else { // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Checks if something is an object.\n *\n * @param {*} val The something you want to check.\n * @return true if val is an object, false otherwise.\n */\nfunction isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nexport function compactObject(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function(accumulator, key) {\n    const isObj = isObject(data[key]);\n    const value = isObj ? compactObject(data[key]) : data[key];\n    const isEmptyObject = isObj && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n    return Object.assign(accumulator, {[key]: value});\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nexport function walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(name => {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(id => {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nexport function filterStats(result, track, outbound) {\n  const streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  const filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  const trackStats = [];\n  result.forEach(value => {\n    if (value.type === 'track' &&\n        value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(trackStat => {\n    result.forEach(stats => {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\nconst logging = utils.log;\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  const constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    const cc = {};\n    Object.keys(c).forEach(key => {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      const r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      const oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        let oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(mix => {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  const shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      const remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      let face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      const getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        let matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n          .then(devices => {\n            devices = devices.filter(d => d.kind === 'videoinput');\n            let dev = devices.find(d => matches.some(match =>\n              d.label.toLowerCase().includes(match)));\n            if (!dev && devices.length && matches.includes('back')) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n            if (dev) {\n              constraints.video.deviceId = face.exact ? {exact: dev.deviceId} :\n                                                        {ideal: dev.deviceId};\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  const shimError_ = function(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  const getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, c => {\n      navigator.webkitGetUserMedia(c, onSuccess, e => {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, c => origGetUserMedia(c).then(stream => {\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(track => {\n            track.stop();\n          });\n          throw new DOMException('', 'NotFoundError');\n        }\n        return stream;\n      }, e => Promise.reject(shimError_(e))));\n    };\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nexport function shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' +\n        'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      return getSourceId(constraints)\n        .then(sourceId => {\n          const widthSpecified = constraints.video && constraints.video.width;\n          const heightSpecified = constraints.video &&\n            constraints.video.height;\n          const frameRateSpecified = constraints.video &&\n            constraints.video.frameRate;\n          constraints.video = {\n            mandatory: {\n              chromeMediaSource: 'desktop',\n              chromeMediaSourceId: sourceId,\n              maxFrameRate: frameRateSpecified || 3\n            }\n          };\n          if (widthSpecified) {\n            constraints.video.mandatory.maxWidth = widthSpecified;\n          }\n          if (heightSpecified) {\n            constraints.video.mandatory.maxHeight = heightSpecified;\n          }\n          return window.navigator.mediaDevices.getUserMedia(constraints);\n        });\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n      window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get() {\n        return this._ontrack;\n      },\n      set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n      enumerable: true,\n      configurable: true\n    });\n    const origSetRemoteDescription =\n        window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        if (!this._ontrackpoly) {\n          this._ontrackpoly = (e) => {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', te => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === te.track.id);\n              } else {\n                receiver = {track: te.track};\n              }\n\n              const event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(track => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === track.id);\n              } else {\n                receiver = {track};\n              }\n              const event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n          };\n          this.addEventListener('addstream', this._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(this, arguments);\n      };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver',\n          {value: {receiver: e.receiver}});\n      }\n      return e;\n    });\n  }\n}\n\nexport function shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if (typeof window === 'object' && window.RTCPeerConnection &&\n      !('getSenders' in window.RTCPeerConnection.prototype) &&\n      'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    const shimSenderWithDtmf = function(pc, track) {\n      return {\n        track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack =\n        function addTrack(track, stream) {\n          let sender = origAddTrack.apply(this, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(this, track);\n            this._senders.push(sender);\n          }\n          return sender;\n        };\n\n      const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack =\n        function removeTrack(sender) {\n          origRemoveTrack.apply(this, arguments);\n          const idx = this._senders.indexOf(sender);\n          if (idx !== -1) {\n            this._senders.splice(idx, 1);\n          }\n        };\n    }\n    const origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(track => {\n        this._senders.push(shimSenderWithDtmf(this, track));\n      });\n    };\n\n    const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        this._senders = this._senders || [];\n        origRemoveStream.apply(this, [stream]);\n\n        stream.getTracks().forEach(track => {\n          const sender = this._senders.find(s => s.track === track);\n          if (sender) { // remove sender\n            this._senders.splice(this._senders.indexOf(sender), 1);\n          }\n        });\n      };\n  } else if (typeof window === 'object' && window.RTCPeerConnection &&\n             'getSenders' in window.RTCPeerConnection.prototype &&\n             'createDTMFSender' in window.RTCPeerConnection.prototype &&\n             window.RTCRtpSender &&\n             !('dtmf' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nexport function shimGetStats(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 ||\n        typeof selector !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n\n    const fixChromeStats_ = function(response) {\n      const standardReport = {};\n      const reports = response.result();\n      reports.forEach(report => {\n        const standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(name => {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    const makeMapStats = function(stats) {\n      return new Map(Object.keys(stats).map(key => [key, stats[key]]));\n    };\n\n    if (arguments.length >= 2) {\n      const successCallbackWrapper_ = function(response) {\n        onSucc(makeMapStats(fixChromeStats_(response)));\n      };\n\n      return origGetStats.apply(this, [successCallbackWrapper_,\n        selector]);\n    }\n\n    // promise-support\n    return new Promise((resolve, reject) => {\n      origGetStats.apply(this, [\n        function(response) {\n          resolve(makeMapStats(fixChromeStats_(response)));\n        }, reject]);\n    }).then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        const senders = origGetSenders.apply(this, []);\n        senders.forEach(sender => sender._pc = this);\n        return senders;\n      };\n    }\n\n    const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        const sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      const sender = this;\n      return this._pc.getStats().then(result =>\n        /* Note: this will include stats of all senders that\n         *   send a track with the same id as sender.track as\n         *   it is not possible to identify the RTCRtpSender.\n         */\n        utils.filterStats(result, sender.track, true));\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers =\n        function getReceivers() {\n          const receivers = origGetReceivers.apply(this, []);\n          receivers.forEach(receiver => receiver._pc = this);\n          return receivers;\n        };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      const receiver = this;\n      return this._pc.getStats().then(result =>\n        utils.filterStats(result, receiver.track, false));\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype &&\n      'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    if (arguments.length > 0 &&\n        arguments[0] instanceof window.MediaStreamTrack) {\n      const track = arguments[0];\n      let sender;\n      let receiver;\n      let err;\n      this.getSenders().forEach(s => {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(r => {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || (sender && receiver)) {\n        return Promise.reject(new DOMException(\n          'There are more than one sender or receiver for the track.',\n          'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException(\n        'There is no sender or receiver for the track.',\n        'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nexport function shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams)\n        .map(streamId => this._shimmedLocalStreams[streamId][0]);\n    };\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      const sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n    });\n    const existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    const newSenders = this.getSenders()\n      .filter(newSender => existingSenders.indexOf(newSender) === -1);\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n  const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(streamId => {\n          const idx = this._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            this._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (this._shimmedLocalStreams[streamId].length === 1) {\n            delete this._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n}\n\nexport function shimAddTrackRemoveTrack(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack &&\n      browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  const origGetLocalStreams = window.RTCPeerConnection.prototype\n      .getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      const nativeStreams = origGetLocalStreams.apply(this);\n      this._reverseStreams = this._reverseStreams || {};\n      return nativeStreams.map(stream => this._reverseStreams[stream.id]);\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      const newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n\n      origRemoveStream.apply(this, [(this._streams[stream.id] || stream)]);\n      delete this._reverseStreams[(this._streams[stream.id] ?\n          this._streams[stream.id].id : stream.id)];\n      delete this._streams[stream.id];\n    };\n\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      const streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(t => t === track)) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n      const oldStream = this._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(() => {\n          this.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        const newStream = new window.MediaStream([track]);\n        this._streams[stream.id] = newStream;\n        this._reverseStreams[newStream.id] = stream;\n        this.addStream(newStream);\n      }\n      return this.getSenders().find(s => s.track === track);\n    };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n          externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n          internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function(method) {\n    const nativeMethod = window.RTCPeerConnection.prototype[method];\n    const methodObj = {[method]() {\n      const args = arguments;\n      const isLegacyCall = arguments.length &&\n          typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [\n          (description) => {\n            const desc = replaceInternalStreamId(this, description);\n            args[0].apply(null, [desc]);\n          },\n          (err) => {\n            if (args[1]) {\n              args[1].apply(null, err);\n            }\n          }, arguments[2]\n        ]);\n      }\n      return nativeMethod.apply(this, arguments)\n      .then(description => replaceInternalStreamId(this, description));\n    }};\n    window.RTCPeerConnection.prototype[method] = methodObj[method];\n  });\n\n  const origSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(this, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(this, arguments[0]);\n      return origSetLocalDescription.apply(this, arguments);\n    };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  const origLocalDescription = Object.getOwnPropertyDescriptor(\n      window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype,\n      'localDescription', {\n        get() {\n          const description = origLocalDescription.get.apply(this);\n          if (description.type === '') {\n            return description;\n          }\n          return replaceInternalStreamId(this, description);\n        }\n      });\n\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      const isLocal = sender._pc === this;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n            'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      this._streams = this._streams || {};\n      let stream;\n      Object.keys(this._streams).forEach(streamid => {\n        const hasTrack = this._streams[streamid].getTracks()\n          .find(track => sender.track === track);\n        if (hasTrack) {\n          stream = this._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          this.removeStream(this._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        this.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  if (browserDetails.version < 53) {\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          const nativeMethod = window.RTCPeerConnection.prototype[method];\n          const methodObj = {[method]() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          }};\n          window.RTCPeerConnection.prototype[method] = methodObj[method];\n        });\n  }\n}\n\n// Attempt to fix ONN in plan-b mode.\nexport function fixNegotiationNeeded(window, browserDetails) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', e => {\n    const pc = e.target;\n    if (browserDetails.version < 72 || (pc.getConfiguration &&\n        pc.getConfiguration().sdpSemantics === 'plan-b')) {\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n    }\n    return e;\n  });\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  const shimError_ = function(e) {\n    return {\n      name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint,\n      toString() {\n        return this.name;\n      }\n    };\n  };\n\n  // getUserMedia error shim.\n  const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function(c) {\n    return origGetUserMedia(c).catch(e => Promise.reject(shimError_(e)));\n  };\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window) {\n  if (!('getDisplayMedia' in window.navigator)) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    window.navigator.getDisplayMedia.bind(window.navigator);\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nimport {filterIceServers} from './filtericeservers';\nimport shimRTCPeerConnection from 'rtcpeerconnection-shim';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (window.RTCIceGatherer) {\n    if (!window.RTCIceCandidate) {\n      window.RTCIceCandidate = function RTCIceCandidate(args) {\n        return args;\n      };\n    }\n    if (!window.RTCSessionDescription) {\n      window.RTCSessionDescription = function RTCSessionDescription(args) {\n        return args;\n      };\n    }\n    // this adds an additional event listener to MediaStrackTrack that signals\n    // when a tracks enabled property was changed. Workaround for a bug in\n    // addStream, see below. No longer required in 15025+\n    if (browserDetails.version < 15025) {\n      const origMSTEnabled = Object.getOwnPropertyDescriptor(\n          window.MediaStreamTrack.prototype, 'enabled');\n      Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {\n        set(value) {\n          origMSTEnabled.set.call(this, value);\n          const ev = new Event('enabled');\n          ev.enabled = value;\n          this.dispatchEvent(ev);\n        }\n      });\n    }\n  }\n\n  // ORTC defines the DTMF sender a bit different.\n  // https://github.com/w3c/ortc/issues/714\n  if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = new window.RTCDtmfSender(this);\n          } else if (this.track.kind === 'video') {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n  // Edge currently only implements the RTCDtmfSender, not the\n  // RTCDTMFSender alias. See http://draft.ortc.org/#rtcdtmfsender2*\n  if (window.RTCDtmfSender && !window.RTCDTMFSender) {\n    window.RTCDTMFSender = window.RTCDtmfSender;\n  }\n\n  const RTCPeerConnectionShim = shimRTCPeerConnection(window,\n      browserDetails.version);\n  window.RTCPeerConnection = function RTCPeerConnection(config) {\n    if (config && config.iceServers) {\n      config.iceServers = filterIceServers(config.iceServers,\n        browserDetails.version);\n      utils.log('ICE servers after filtering:', config.iceServers);\n    }\n    return new RTCPeerConnectionShim(config);\n  };\n  window.RTCPeerConnection.prototype = RTCPeerConnectionShim.prototype;\n}\n\nexport function shimReplaceTrack(window) {\n  // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\n  if (window.RTCRtpSender &&\n      !('replaceTrack' in window.RTCRtpSender.prototype)) {\n    window.RTCRtpSender.prototype.replaceTrack =\n        window.RTCRtpSender.prototype.setTrack;\n  }\n}\n","/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nexport function filterIceServers(iceServers, edgeVersion) {\n  let hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(server => {\n    if (server && (server.urls || server.url)) {\n      let urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      const isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(url => {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n\n        const validTurn = url.startsWith('turn') &&\n            !url.startsWith('turn:[') &&\n            url.includes('transport=udp');\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return validTurn && !hasTurn;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n  const MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n        'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    const remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    const nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      const nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        const obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      const nativeApplyConstraints =\n        MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      if (!(constraints && constraints.video)) {\n        const err = new DOMException('getDisplayMedia without video ' +\n            'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = {mediaSource: preferredMediaSource};\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      ('receiver' in window.RTCTrackEvent.prototype) &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (typeof window !== 'object' ||\n      !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          const nativeMethod = window.RTCPeerConnection.prototype[method];\n          const methodObj = {[method]() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          }};\n          window.RTCPeerConnection.prototype[method] = methodObj[method];\n        });\n  }\n\n  const modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  const nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n    return nativeGetStats.apply(this, [selector || null])\n      .then(stats => {\n        if (browserDetails.version < 53 && !onSucc) {\n          // Shim only promise getStats with spec-hyphens in type names\n          // Leave callback version alone; misc old uses of forEach before Map\n          try {\n            stats.forEach(stat => {\n              stat.type = modernStatsTypes[stat.type] || stat.type;\n            });\n          } catch (e) {\n            if (e.name !== 'TypeError') {\n              throw e;\n            }\n            // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n            stats.forEach((stat, i) => {\n              stats.set(i, Object.assign({}, stat, {\n                type: modernStatsTypes[stat.type] || stat.type\n              }));\n            });\n          }\n        }\n        return stats;\n      })\n      .then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n  }\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      const sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) :\n        Promise.resolve(new Map());\n  };\n}\n\nexport function shimReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      const receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(receiver => receiver._pc = this);\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', e => {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\n\nexport function shimRemoveStream(window) {\n  if (!window.RTCPeerConnection ||\n      'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(sender => {\n        if (sender.track && stream.getTracks().includes(sender.track)) {\n          this.removeTrack(sender);\n        }\n      });\n    };\n}\n\nexport function shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\nexport function shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver =\n      function addTransceiver() {\n        this.setParametersPromises = [];\n        const initParameters = arguments[1];\n        const shouldPerformCheck = initParameters &&\n                                  'sendEncodings' in initParameters;\n        if (shouldPerformCheck) {\n          // If sendEncodings params are provided, validate grammar\n          initParameters.sendEncodings.forEach((encodingParam) => {\n            if ('rid' in encodingParam) {\n              const ridRegex = /^[a-z0-9]{0,16}$/i;\n              if (!ridRegex.test(encodingParam.rid)) {\n                throw new TypeError('Invalid RID value provided.');\n              }\n            }\n            if ('scaleResolutionDownBy' in encodingParam) {\n              if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n                throw new RangeError('scale_resolution_down_by must be >= 1.0');\n              }\n            }\n            if ('maxFramerate' in encodingParam) {\n              if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n                throw new RangeError('max_framerate must be >= 0.0');\n              }\n            }\n          });\n        }\n        const transceiver = origAddTransceiver.apply(this, arguments);\n        if (shouldPerformCheck) {\n          // Check if the init options were applied. If not we do this in an\n          // asynchronous way and save the promise reference in a global object.\n          // This is an ugly hack, but at the same time is way more robust than\n          // checking the sender parameters before and after the createOffer\n          // Also note that after the createoffer we are not 100% sure that\n          // the params were asynchronously applied so we might miss the\n          // opportunity to recreate offer.\n          const {sender} = transceiver;\n          const params = sender.getParameters();\n          if (!('encodings' in params) ||\n              // Avoid being fooled by patched getParameters() below.\n              (params.encodings.length === 1 &&\n               Object.keys(params.encodings[0]).length === 0)) {\n            params.encodings = initParameters.sendEncodings;\n            sender.sendEncodings = initParameters.sendEncodings;\n            this.setParametersPromises.push(sender.setParameters(params)\n              .then(() => {\n                delete sender.sendEncodings;\n              }).catch(() => {\n                delete sender.sendEncodings;\n              })\n            );\n          }\n        }\n        return transceiver;\n      };\n  }\n}\n\nexport function shimGetParameters(window) {\n  if (!(typeof window === 'object' && window.RTCRtpSender)) {\n    return;\n  }\n  const origGetParameters = window.RTCRtpSender.prototype.getParameters;\n  if (origGetParameters) {\n    window.RTCRtpSender.prototype.getParameters =\n      function getParameters() {\n        const params = origGetParameters.apply(this, arguments);\n        if (!('encodings' in params)) {\n          params.encodings = [].concat(this.sendEncodings || [{}]);\n        }\n        return params;\n      };\n  }\n}\n\nexport function shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n      .then(() => {\n        return origCreateOffer.apply(this, arguments);\n      })\n      .finally(() => {\n        this.setParametersPromises = [];\n      });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nexport function shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n      .then(() => {\n        return origCreateAnswer.apply(this, arguments);\n      })\n      .finally(() => {\n        this.setParametersPromises = [];\n      });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nimport * as utils from '../utils';\n\nexport function shimLocalStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams =\n      function getLocalStreams() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    const _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      // Try to emulate Chrome's behaviour of adding in audio-video order.\n      // Safari orders by track id.\n      stream.getAudioTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n      stream.getVideoTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n    };\n\n    window.RTCPeerConnection.prototype.addTrack =\n      function addTrack(track, ...streams) {\n        if (streams) {\n          streams.forEach((stream) => {\n            if (!this._localStreams) {\n              this._localStreams = [stream];\n            } else if (!this._localStreams.includes(stream)) {\n              this._localStreams.push(stream);\n            }\n          });\n        }\n        return _addTrack.apply(this, arguments);\n      };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        const index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        const tracks = stream.getTracks();\n        this.getSenders().forEach(sender => {\n          if (tracks.includes(sender.track)) {\n            this.removeTrack(sender);\n          }\n        });\n      };\n  }\n}\n\nexport function shimRemoteStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams =\n      function getRemoteStreams() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get() {\n        return this._onaddstream;\n      },\n      set(f) {\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = (e) => {\n          e.streams.forEach(stream => {\n            if (!this._remoteStreams) {\n              this._remoteStreams = [];\n            }\n            if (this._remoteStreams.includes(stream)) {\n              return;\n            }\n            this._remoteStreams.push(stream);\n            const event = new Event('addstream');\n            event.stream = stream;\n            this.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        const pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            e.streams.forEach(stream => {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              const event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n  }\n}\n\nexport function shimCallbacksAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  const prototype = window.RTCPeerConnection.prototype;\n  const origCreateOffer = prototype.createOffer;\n  const origCreateAnswer = prototype.createAnswer;\n  const setLocalDescription = prototype.setLocalDescription;\n  const setRemoteDescription = prototype.setRemoteDescription;\n  const addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer =\n    function createOffer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  prototype.createAnswer =\n    function createAnswer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  let withCallback = function(description, successCallback, failureCallback) {\n    const promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function(description, successCallback, failureCallback) {\n    const promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function(candidate, successCallback, failureCallback) {\n    const promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    const mediaDevices = navigator.mediaDevices;\n    const _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = (constraints) => {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices &&\n    navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints)\n      .then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nexport function shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({},\n      constraints,\n      {video: utils.compactObject(constraints.video)}\n    );\n  }\n\n  return constraints;\n}\n\nexport function shimRTCIceServerUrls(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  const OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection =\n    function RTCPeerConnection(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        const newIceServers = [];\n        for (let i = 0; i < pcConfig.iceServers.length; i++) {\n          let server = pcConfig.iceServers[i];\n          if (!server.hasOwnProperty('urls') &&\n              server.hasOwnProperty('url')) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in OrigPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nexport function shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      'receiver' in window.RTCTrackEvent.prototype &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimCreateOfferLegacy(window) {\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer =\n    function createOffer(offerOptions) {\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio =\n            !!offerOptions.offerToReceiveAudio;\n        }\n        const audioTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'audio');\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          this.addTransceiver('audio');\n        }\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo =\n            !!offerOptions.offerToReceiveVideo;\n        }\n        const videoTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'video');\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('sendonly');\n            } else {\n              videoTransceiver.direction = 'sendonly';\n            }\n          } else if (videoTransceiver.direction === 'recvonly') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('inactive');\n            } else {\n              videoTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          this.addTransceiver('video');\n        }\n      }\n      return origCreateOffer.apply(this, arguments);\n    };\n}\n\nexport function shimAudioContext(window) {\n  if (typeof window !== 'object' || window.AudioContext) {\n    return;\n  }\n  window.AudioContext = window.webkitAudioContext;\n}\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport SDPUtils from 'sdp';\nimport * as utils from './utils';\n\nexport function shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  const NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function RTCIceCandidate(args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if (typeof args === 'object' && args.candidate &&\n        args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substr(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      const nativeCandidate = new NativeRTCIceCandidate(args);\n      const parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n      const augmentedCandidate = Object.assign(nativeCandidate,\n          parsedCandidate);\n\n      // Add a serializer that does not serialize the extra attributes.\n      augmentedCandidate.toJSON = function toJSON() {\n        return {\n          candidate: augmentedCandidate.candidate,\n          sdpMid: augmentedCandidate.sdpMid,\n          sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n          usernameFragment: augmentedCandidate.usernameFragment,\n        };\n      };\n      return augmentedCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nexport function shimMaxMessageSize(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  const sctpInDescription = function(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    const sections = SDPUtils.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(mediaSection => {\n      const mLine = SDPUtils.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application'\n          && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  const getRemoteFirefoxVersion = function(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    const match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    const version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  const getCanSendMaxMessageSize = function(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    let canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize =\n          browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  const getMaxMessageSize = function(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    let maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox'\n         && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    const match = SDPUtils.matchPrefix(description.sdp,\n      'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substr(19), 10);\n    } else if (browserDetails.browser === 'firefox' &&\n                remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n    function setRemoteDescription() {\n      this._sctp = null;\n      // Chrome decided to not expose .sctp in plan-b mode.\n      // As usual, adapter.js has to do an 'ugly worakaround'\n      // to cover up the mess.\n      if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n        const {sdpSemantics} = this.getConfiguration();\n        if (sdpSemantics === 'plan-b') {\n          Object.defineProperty(this, 'sctp', {\n            get() {\n              return typeof this._sctp === 'undefined' ? null : this._sctp;\n            },\n            enumerable: true,\n            configurable: true,\n          });\n        }\n      }\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        const isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        const canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        const remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        let maxMessageSize;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        const sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get() {\n            return maxMessageSize;\n          }\n        });\n        this._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n}\n\nexport function shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection &&\n      'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    const origDataChannelSend = dc.send;\n    dc.send = function send() {\n      const data = arguments[0];\n      const length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' &&\n          pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' +\n          pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  const origCreateDataChannel =\n    window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel =\n    function createDataChannel() {\n      const dataChannel = origCreateDataChannel.apply(this, arguments);\n      wrapDcSend(dataChannel, this);\n      return dataChannel;\n    };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', e => {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nexport function shimConnectionState(window) {\n  if (!window.RTCPeerConnection ||\n      'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get() {\n      return this._onconnectionstatechange || null;\n    },\n    set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange',\n            this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange',\n            this._onconnectionstatechange = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach((method) => {\n    const origMethod = proto[method];\n    proto[method] = function() {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = e => {\n          const pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            const newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange',\n          this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nexport function removeExtmapAllowMixed(window, browserDetails) {\n  /* remove a=extmap-allow-mixed for webrtc.org < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  if (browserDetails.browser === 'safari' && browserDetails.version >= 605) {\n    return;\n  }\n  const nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n  function setRemoteDescription(desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      const sdp = desc.sdp.split('\\n').filter((line) => {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n      // Safari enforces read-only-ness of RTCSessionDescription fields.\n      if (window.RTCSessionDescription &&\n          desc instanceof window.RTCSessionDescription) {\n        arguments[0] = new window.RTCSessionDescription({\n          type: desc.type,\n          sdp,\n        });\n      } else {\n        desc.sdp = sdp;\n      }\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n\nexport function shimAddIceCandidateNullOrEmpty(window, browserDetails) {\n  // Support for addIceCandidate(null or undefined)\n  // as well as addIceCandidate({candidate: \"\", ...})\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=978582\n  // Note: must be called before other polyfills which change the signature.\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeAddIceCandidate =\n      window.RTCPeerConnection.prototype.addIceCandidate;\n  if (!nativeAddIceCandidate || nativeAddIceCandidate.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.addIceCandidate =\n    function addIceCandidate() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions.\n      // Native support for ignoring exists for Chrome M77+.\n      // Safari ignores as well, exact version unknown but works in the same\n      // version that also ignores addIceCandidate(null).\n      if (((browserDetails.browser === 'chrome' && browserDetails.version < 78)\n           || (browserDetails.browser === 'firefox'\n               && browserDetails.version < 68)\n           || (browserDetails.browser === 'safari'))\n          && arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nimport {adapterFactory} from './adapter_factory.js';\n\nconst adapter =\n  adapterFactory({window: typeof window === 'undefined' ? undefined : window});\nexport default adapter;\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nimport * as utils from './utils';\n\n  // Browser shims.\nimport * as chromeShim from './chrome/chrome_shim';\nimport * as edgeShim from './edge/edge_shim';\nimport * as firefoxShim from './firefox/firefox_shim';\nimport * as safariShim from './safari/safari_shim';\nimport * as commonShim from './common_shim';\n\n// Shimming starts here.\nexport function adapterFactory({window} = {}, options = {\n  shimChrome: true,\n  shimFirefox: true,\n  shimEdge: true,\n  shimSafari: true,\n}) {\n  // Utils.\n  const logging = utils.log;\n  const browserDetails = utils.detectBrowser(window);\n\n  const adapter = {\n    browserDetails,\n    commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      if (browserDetails.version === null) {\n        logging('Chrome shim can not determine version, not shimming.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n\n      chromeShim.shimGetUserMedia(window, browserDetails);\n      chromeShim.shimMediaStream(window, browserDetails);\n      chromeShim.shimPeerConnection(window, browserDetails);\n      chromeShim.shimOnTrack(window, browserDetails);\n      chromeShim.shimAddTrackRemoveTrack(window, browserDetails);\n      chromeShim.shimGetSendersWithDtmf(window, browserDetails);\n      chromeShim.shimGetStats(window, browserDetails);\n      chromeShim.shimSenderReceiverGetStats(window, browserDetails);\n      chromeShim.fixNegotiationNeeded(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n\n      firefoxShim.shimGetUserMedia(window, browserDetails);\n      firefoxShim.shimPeerConnection(window, browserDetails);\n      firefoxShim.shimOnTrack(window, browserDetails);\n      firefoxShim.shimRemoveStream(window, browserDetails);\n      firefoxShim.shimSenderGetStats(window, browserDetails);\n      firefoxShim.shimReceiverGetStats(window, browserDetails);\n      firefoxShim.shimRTCDataChannel(window, browserDetails);\n      firefoxShim.shimAddTransceiver(window, browserDetails);\n      firefoxShim.shimGetParameters(window, browserDetails);\n      firefoxShim.shimCreateOffer(window, browserDetails);\n      firefoxShim.shimCreateAnswer(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\n        logging('MS edge shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = edgeShim;\n\n      edgeShim.shimGetUserMedia(window, browserDetails);\n      edgeShim.shimGetDisplayMedia(window, browserDetails);\n      edgeShim.shimPeerConnection(window, browserDetails);\n      edgeShim.shimReplaceTrack(window, browserDetails);\n\n      // the edge shim implements the full RTCIceCandidate object.\n\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      // Must be called before shimCallbackAPI.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n\n      safariShim.shimRTCIceServerUrls(window, browserDetails);\n      safariShim.shimCreateOfferLegacy(window, browserDetails);\n      safariShim.shimCallbacksAPI(window, browserDetails);\n      safariShim.shimLocalStreamsAPI(window, browserDetails);\n      safariShim.shimRemoteStreamsAPI(window, browserDetails);\n      safariShim.shimTrackEventTransceiver(window, browserDetails);\n      safariShim.shimGetUserMedia(window, browserDetails);\n      safariShim.shimAudioContext(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n","var mode = require('./mode');\n\nfunction QR8bitByte(data) {\n\tthis.mode = mode.MODE_8BIT_BYTE;\n\tthis.data = data;\n}\n\nQR8bitByte.prototype = {\n\n\tgetLength : function(buffer) {\n\t\treturn this.data.length;\n\t},\n\t\n\twrite : function(buffer) {\n\t\tfor (var i = 0; i < this.data.length; i++) {\n\t\t\t// not JIS ...\n\t\t\tbuffer.put(this.data.charCodeAt(i), 8);\n\t\t}\n\t}\n};\n\nmodule.exports = QR8bitByte;\n\n","// ErrorCorrectLevel\nvar ECL = require('./ErrorCorrectLevel');\n\nfunction QRRSBlock(totalCount, dataCount) {\n\tthis.totalCount = totalCount;\n\tthis.dataCount  = dataCount;\n}\n\nQRRSBlock.RS_BLOCK_TABLE = [\n\n\t// L\n\t// M\n\t// Q\n\t// H\n\n\t// 1\n\t[1, 26, 19],\n\t[1, 26, 16],\n\t[1, 26, 13],\n\t[1, 26, 9],\n\t\n\t// 2\n\t[1, 44, 34],\n\t[1, 44, 28],\n\t[1, 44, 22],\n\t[1, 44, 16],\n\n\t// 3\n\t[1, 70, 55],\n\t[1, 70, 44],\n\t[2, 35, 17],\n\t[2, 35, 13],\n\n\t// 4\t\t\n\t[1, 100, 80],\n\t[2, 50, 32],\n\t[2, 50, 24],\n\t[4, 25, 9],\n\t\n\t// 5\n\t[1, 134, 108],\n\t[2, 67, 43],\n\t[2, 33, 15, 2, 34, 16],\n\t[2, 33, 11, 2, 34, 12],\n\t\n\t// 6\n\t[2, 86, 68],\n\t[4, 43, 27],\n\t[4, 43, 19],\n\t[4, 43, 15],\n\t\n\t// 7\t\t\n\t[2, 98, 78],\n\t[4, 49, 31],\n\t[2, 32, 14, 4, 33, 15],\n\t[4, 39, 13, 1, 40, 14],\n\t\n\t// 8\n\t[2, 121, 97],\n\t[2, 60, 38, 2, 61, 39],\n\t[4, 40, 18, 2, 41, 19],\n\t[4, 40, 14, 2, 41, 15],\n\t\n\t// 9\n\t[2, 146, 116],\n\t[3, 58, 36, 2, 59, 37],\n\t[4, 36, 16, 4, 37, 17],\n\t[4, 36, 12, 4, 37, 13],\n\t\n\t// 10\t\t\n\t[2, 86, 68, 2, 87, 69],\n\t[4, 69, 43, 1, 70, 44],\n\t[6, 43, 19, 2, 44, 20],\n\t[6, 43, 15, 2, 44, 16],\n\n\t// 11\n\t[4, 101, 81],\n\t[1, 80, 50, 4, 81, 51],\n\t[4, 50, 22, 4, 51, 23],\n\t[3, 36, 12, 8, 37, 13],\n\n\t// 12\n\t[2, 116, 92, 2, 117, 93],\n\t[6, 58, 36, 2, 59, 37],\n\t[4, 46, 20, 6, 47, 21],\n\t[7, 42, 14, 4, 43, 15],\n\n\t// 13\n\t[4, 133, 107],\n\t[8, 59, 37, 1, 60, 38],\n\t[8, 44, 20, 4, 45, 21],\n\t[12, 33, 11, 4, 34, 12],\n\n\t// 14\n\t[3, 145, 115, 1, 146, 116],\n\t[4, 64, 40, 5, 65, 41],\n\t[11, 36, 16, 5, 37, 17],\n\t[11, 36, 12, 5, 37, 13],\n\n\t// 15\n\t[5, 109, 87, 1, 110, 88],\n\t[5, 65, 41, 5, 66, 42],\n\t[5, 54, 24, 7, 55, 25],\n\t[11, 36, 12],\n\n\t// 16\n\t[5, 122, 98, 1, 123, 99],\n\t[7, 73, 45, 3, 74, 46],\n\t[15, 43, 19, 2, 44, 20],\n\t[3, 45, 15, 13, 46, 16],\n\n\t// 17\n\t[1, 135, 107, 5, 136, 108],\n\t[10, 74, 46, 1, 75, 47],\n\t[1, 50, 22, 15, 51, 23],\n\t[2, 42, 14, 17, 43, 15],\n\n\t// 18\n\t[5, 150, 120, 1, 151, 121],\n\t[9, 69, 43, 4, 70, 44],\n\t[17, 50, 22, 1, 51, 23],\n\t[2, 42, 14, 19, 43, 15],\n\n\t// 19\n\t[3, 141, 113, 4, 142, 114],\n\t[3, 70, 44, 11, 71, 45],\n\t[17, 47, 21, 4, 48, 22],\n\t[9, 39, 13, 16, 40, 14],\n\n\t// 20\n\t[3, 135, 107, 5, 136, 108],\n\t[3, 67, 41, 13, 68, 42],\n\t[15, 54, 24, 5, 55, 25],\n\t[15, 43, 15, 10, 44, 16],\n\n\t// 21\n\t[4, 144, 116, 4, 145, 117],\n\t[17, 68, 42],\n\t[17, 50, 22, 6, 51, 23],\n\t[19, 46, 16, 6, 47, 17],\n\n\t// 22\n\t[2, 139, 111, 7, 140, 112],\n\t[17, 74, 46],\n\t[7, 54, 24, 16, 55, 25],\n\t[34, 37, 13],\n\n\t// 23\n\t[4, 151, 121, 5, 152, 122],\n\t[4, 75, 47, 14, 76, 48],\n\t[11, 54, 24, 14, 55, 25],\n\t[16, 45, 15, 14, 46, 16],\n\n\t// 24\n\t[6, 147, 117, 4, 148, 118],\n\t[6, 73, 45, 14, 74, 46],\n\t[11, 54, 24, 16, 55, 25],\n\t[30, 46, 16, 2, 47, 17],\n\n\t// 25\n\t[8, 132, 106, 4, 133, 107],\n\t[8, 75, 47, 13, 76, 48],\n\t[7, 54, 24, 22, 55, 25],\n\t[22, 45, 15, 13, 46, 16],\n\n\t// 26\n\t[10, 142, 114, 2, 143, 115],\n\t[19, 74, 46, 4, 75, 47],\n\t[28, 50, 22, 6, 51, 23],\n\t[33, 46, 16, 4, 47, 17],\n\n\t// 27\n\t[8, 152, 122, 4, 153, 123],\n\t[22, 73, 45, 3, 74, 46],\n\t[8, 53, 23, 26, 54, 24],\n\t[12, 45, 15, 28, 46, 16],\n\n\t// 28\n\t[3, 147, 117, 10, 148, 118],\n\t[3, 73, 45, 23, 74, 46],\n\t[4, 54, 24, 31, 55, 25],\n\t[11, 45, 15, 31, 46, 16],\n\n\t// 29\n\t[7, 146, 116, 7, 147, 117],\n\t[21, 73, 45, 7, 74, 46],\n\t[1, 53, 23, 37, 54, 24],\n\t[19, 45, 15, 26, 46, 16],\n\n\t// 30\n\t[5, 145, 115, 10, 146, 116],\n\t[19, 75, 47, 10, 76, 48],\n\t[15, 54, 24, 25, 55, 25],\n\t[23, 45, 15, 25, 46, 16],\n\n\t// 31\n\t[13, 145, 115, 3, 146, 116],\n\t[2, 74, 46, 29, 75, 47],\n\t[42, 54, 24, 1, 55, 25],\n\t[23, 45, 15, 28, 46, 16],\n\n\t// 32\n\t[17, 145, 115],\n\t[10, 74, 46, 23, 75, 47],\n\t[10, 54, 24, 35, 55, 25],\n\t[19, 45, 15, 35, 46, 16],\n\n\t// 33\n\t[17, 145, 115, 1, 146, 116],\n\t[14, 74, 46, 21, 75, 47],\n\t[29, 54, 24, 19, 55, 25],\n\t[11, 45, 15, 46, 46, 16],\n\n\t// 34\n\t[13, 145, 115, 6, 146, 116],\n\t[14, 74, 46, 23, 75, 47],\n\t[44, 54, 24, 7, 55, 25],\n\t[59, 46, 16, 1, 47, 17],\n\n\t// 35\n\t[12, 151, 121, 7, 152, 122],\n\t[12, 75, 47, 26, 76, 48],\n\t[39, 54, 24, 14, 55, 25],\n\t[22, 45, 15, 41, 46, 16],\n\n\t// 36\n\t[6, 151, 121, 14, 152, 122],\n\t[6, 75, 47, 34, 76, 48],\n\t[46, 54, 24, 10, 55, 25],\n\t[2, 45, 15, 64, 46, 16],\n\n\t// 37\n\t[17, 152, 122, 4, 153, 123],\n\t[29, 74, 46, 14, 75, 47],\n\t[49, 54, 24, 10, 55, 25],\n\t[24, 45, 15, 46, 46, 16],\n\n\t// 38\n\t[4, 152, 122, 18, 153, 123],\n\t[13, 74, 46, 32, 75, 47],\n\t[48, 54, 24, 14, 55, 25],\n\t[42, 45, 15, 32, 46, 16],\n\n\t// 39\n\t[20, 147, 117, 4, 148, 118],\n\t[40, 75, 47, 7, 76, 48],\n\t[43, 54, 24, 22, 55, 25],\n\t[10, 45, 15, 67, 46, 16],\n\n\t// 40\n\t[19, 148, 118, 6, 149, 119],\n\t[18, 75, 47, 31, 76, 48],\n\t[34, 54, 24, 34, 55, 25],\n\t[20, 45, 15, 61, 46, 16]\n];\n\nQRRSBlock.getRSBlocks = function(typeNumber, errorCorrectLevel) {\n\t\n\tvar rsBlock = QRRSBlock.getRsBlockTable(typeNumber, errorCorrectLevel);\n\t\n\tif (rsBlock == undefined) {\n\t\tthrow new Error(\"bad rs block @ typeNumber:\" + typeNumber + \"/errorCorrectLevel:\" + errorCorrectLevel);\n\t}\n\n\tvar length = rsBlock.length / 3;\n\t\n\tvar list = new Array();\n\t\n\tfor (var i = 0; i < length; i++) {\n\n\t\tvar count = rsBlock[i * 3 + 0];\n\t\tvar totalCount = rsBlock[i * 3 + 1];\n\t\tvar dataCount  = rsBlock[i * 3 + 2];\n\n\t\tfor (var j = 0; j < count; j++) {\n\t\t\tlist.push(new QRRSBlock(totalCount, dataCount) );\t\n\t\t}\n\t}\n\t\n\treturn list;\n}\n\nQRRSBlock.getRsBlockTable = function(typeNumber, errorCorrectLevel) {\n\n\tswitch(errorCorrectLevel) {\n\tcase ECL.L :\n\t\treturn QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 0];\n\tcase ECL.M :\n\t\treturn QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 1];\n\tcase ECL.Q :\n\t\treturn QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 2];\n\tcase ECL.H :\n\t\treturn QRRSBlock.RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 3];\n\tdefault :\n\t\treturn undefined;\n\t}\n}\n\nmodule.exports = QRRSBlock;\n","function QRBitBuffer() {\n\tthis.buffer = new Array();\n\tthis.length = 0;\n}\n\nQRBitBuffer.prototype = {\n\n\tget : function(index) {\n\t\tvar bufIndex = Math.floor(index / 8);\n\t\treturn ( (this.buffer[bufIndex] >>> (7 - index % 8) ) & 1) == 1;\n\t},\n\t\n\tput : function(num, length) {\n\t\tfor (var i = 0; i < length; i++) {\n\t\t\tthis.putBit( ( (num >>> (length - i - 1) ) & 1) == 1);\n\t\t}\n\t},\n\t\n\tgetLengthInBits : function() {\n\t\treturn this.length;\n\t},\n\t\n\tputBit : function(bit) {\n\t\n\t\tvar bufIndex = Math.floor(this.length / 8);\n\t\tif (this.buffer.length <= bufIndex) {\n\t\t\tthis.buffer.push(0);\n\t\t}\n\t\n\t\tif (bit) {\n\t\t\tthis.buffer[bufIndex] |= (0x80 >>> (this.length % 8) );\n\t\t}\n\t\n\t\tthis.length++;\n\t}\n};\n\nmodule.exports = QRBitBuffer;\n","var Mode = require('./mode');\nvar Polynomial = require('./Polynomial');\nvar math = require('./math');\n\nvar QRMaskPattern = {\n\tPATTERN000 : 0,\n\tPATTERN001 : 1,\n\tPATTERN010 : 2,\n\tPATTERN011 : 3,\n\tPATTERN100 : 4,\n\tPATTERN101 : 5,\n\tPATTERN110 : 6,\n\tPATTERN111 : 7\n};\n\nvar QRUtil = {\n\n    PATTERN_POSITION_TABLE : [\n\t    [],\n\t    [6, 18],\n\t    [6, 22],\n\t    [6, 26],\n\t    [6, 30],\n\t    [6, 34],\n\t    [6, 22, 38],\n\t    [6, 24, 42],\n\t    [6, 26, 46],\n\t    [6, 28, 50],\n\t    [6, 30, 54],\t\t\n\t    [6, 32, 58],\n\t    [6, 34, 62],\n\t    [6, 26, 46, 66],\n\t    [6, 26, 48, 70],\n\t    [6, 26, 50, 74],\n\t    [6, 30, 54, 78],\n\t    [6, 30, 56, 82],\n\t    [6, 30, 58, 86],\n\t    [6, 34, 62, 90],\n\t    [6, 28, 50, 72, 94],\n\t    [6, 26, 50, 74, 98],\n\t    [6, 30, 54, 78, 102],\n\t    [6, 28, 54, 80, 106],\n\t    [6, 32, 58, 84, 110],\n\t    [6, 30, 58, 86, 114],\n\t    [6, 34, 62, 90, 118],\n\t    [6, 26, 50, 74, 98, 122],\n\t    [6, 30, 54, 78, 102, 126],\n\t    [6, 26, 52, 78, 104, 130],\n\t    [6, 30, 56, 82, 108, 134],\n\t    [6, 34, 60, 86, 112, 138],\n\t    [6, 30, 58, 86, 114, 142],\n\t    [6, 34, 62, 90, 118, 146],\n\t    [6, 30, 54, 78, 102, 126, 150],\n\t    [6, 24, 50, 76, 102, 128, 154],\n\t    [6, 28, 54, 80, 106, 132, 158],\n\t    [6, 32, 58, 84, 110, 136, 162],\n\t    [6, 26, 54, 82, 110, 138, 166],\n\t    [6, 30, 58, 86, 114, 142, 170]\n    ],\n\n    G15 : (1 << 10) | (1 << 8) | (1 << 5) | (1 << 4) | (1 << 2) | (1 << 1) | (1 << 0),\n    G18 : (1 << 12) | (1 << 11) | (1 << 10) | (1 << 9) | (1 << 8) | (1 << 5) | (1 << 2) | (1 << 0),\n    G15_MASK : (1 << 14) | (1 << 12) | (1 << 10)\t| (1 << 4) | (1 << 1),\n\n    getBCHTypeInfo : function(data) {\n\t    var d = data << 10;\n\t    while (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G15) >= 0) {\n\t\t    d ^= (QRUtil.G15 << (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G15) ) ); \t\n\t    }\n\t    return ( (data << 10) | d) ^ QRUtil.G15_MASK;\n    },\n\n    getBCHTypeNumber : function(data) {\n\t    var d = data << 12;\n\t    while (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G18) >= 0) {\n\t\t    d ^= (QRUtil.G18 << (QRUtil.getBCHDigit(d) - QRUtil.getBCHDigit(QRUtil.G18) ) ); \t\n\t    }\n\t    return (data << 12) | d;\n    },\n\n    getBCHDigit : function(data) {\n\n\t    var digit = 0;\n\n\t    while (data != 0) {\n\t\t    digit++;\n\t\t    data >>>= 1;\n\t    }\n\n\t    return digit;\n    },\n\n    getPatternPosition : function(typeNumber) {\n\t    return QRUtil.PATTERN_POSITION_TABLE[typeNumber - 1];\n    },\n\n    getMask : function(maskPattern, i, j) {\n\t    \n\t    switch (maskPattern) {\n\t\t    \n\t    case QRMaskPattern.PATTERN000 : return (i + j) % 2 == 0;\n\t    case QRMaskPattern.PATTERN001 : return i % 2 == 0;\n\t    case QRMaskPattern.PATTERN010 : return j % 3 == 0;\n\t    case QRMaskPattern.PATTERN011 : return (i + j) % 3 == 0;\n\t    case QRMaskPattern.PATTERN100 : return (Math.floor(i / 2) + Math.floor(j / 3) ) % 2 == 0;\n\t    case QRMaskPattern.PATTERN101 : return (i * j) % 2 + (i * j) % 3 == 0;\n\t    case QRMaskPattern.PATTERN110 : return ( (i * j) % 2 + (i * j) % 3) % 2 == 0;\n\t    case QRMaskPattern.PATTERN111 : return ( (i * j) % 3 + (i + j) % 2) % 2 == 0;\n\n\t    default :\n\t\t    throw new Error(\"bad maskPattern:\" + maskPattern);\n\t    }\n    },\n\n    getErrorCorrectPolynomial : function(errorCorrectLength) {\n\n\t    var a = new Polynomial([1], 0);\n\n\t    for (var i = 0; i < errorCorrectLength; i++) {\n\t\t    a = a.multiply(new Polynomial([1, math.gexp(i)], 0) );\n\t    }\n\n\t    return a;\n    },\n\n    getLengthInBits : function(mode, type) {\n\n\t    if (1 <= type && type < 10) {\n\n\t\t    // 1 - 9\n\n\t\t    switch(mode) {\n\t\t    case Mode.MODE_NUMBER \t: return 10;\n\t\t    case Mode.MODE_ALPHA_NUM \t: return 9;\n\t\t    case Mode.MODE_8BIT_BYTE\t: return 8;\n\t\t    case Mode.MODE_KANJI  \t: return 8;\n\t\t    default :\n\t\t\t    throw new Error(\"mode:\" + mode);\n\t\t    }\n\n\t    } else if (type < 27) {\n\n\t\t    // 10 - 26\n\n\t\t    switch(mode) {\n\t\t    case Mode.MODE_NUMBER \t: return 12;\n\t\t    case Mode.MODE_ALPHA_NUM \t: return 11;\n\t\t    case Mode.MODE_8BIT_BYTE\t: return 16;\n\t\t    case Mode.MODE_KANJI  \t: return 10;\n\t\t    default :\n\t\t\t    throw new Error(\"mode:\" + mode);\n\t\t    }\n\n\t    } else if (type < 41) {\n\n\t\t    // 27 - 40\n\n\t\t    switch(mode) {\n\t\t    case Mode.MODE_NUMBER \t: return 14;\n\t\t    case Mode.MODE_ALPHA_NUM\t: return 13;\n\t\t    case Mode.MODE_8BIT_BYTE\t: return 16;\n\t\t    case Mode.MODE_KANJI  \t: return 12;\n\t\t    default :\n\t\t\t    throw new Error(\"mode:\" + mode);\n\t\t    }\n\n\t    } else {\n\t\t    throw new Error(\"type:\" + type);\n\t    }\n    },\n\n    getLostPoint : function(qrCode) {\n\t    \n\t    var moduleCount = qrCode.getModuleCount();\n\t    \n\t    var lostPoint = 0;\n\t    \n\t    // LEVEL1\n\t    \n\t    for (var row = 0; row < moduleCount; row++) {\n\n\t\t    for (var col = 0; col < moduleCount; col++) {\n\n\t\t\t    var sameCount = 0;\n\t\t\t    var dark = qrCode.isDark(row, col);\n\n\t\t\t\tfor (var r = -1; r <= 1; r++) {\n\n\t\t\t\t    if (row + r < 0 || moduleCount <= row + r) {\n\t\t\t\t\t    continue;\n\t\t\t\t    }\n\n\t\t\t\t    for (var c = -1; c <= 1; c++) {\n\n\t\t\t\t\t    if (col + c < 0 || moduleCount <= col + c) {\n\t\t\t\t\t\t    continue;\n\t\t\t\t\t    }\n\n\t\t\t\t\t    if (r == 0 && c == 0) {\n\t\t\t\t\t\t    continue;\n\t\t\t\t\t    }\n\n\t\t\t\t\t    if (dark == qrCode.isDark(row + r, col + c) ) {\n\t\t\t\t\t\t    sameCount++;\n\t\t\t\t\t    }\n\t\t\t\t    }\n\t\t\t    }\n\n\t\t\t    if (sameCount > 5) {\n\t\t\t\t    lostPoint += (3 + sameCount - 5);\n\t\t\t    }\n\t\t    }\n\t    }\n\n\t    // LEVEL2\n\n\t    for (var row = 0; row < moduleCount - 1; row++) {\n\t\t    for (var col = 0; col < moduleCount - 1; col++) {\n\t\t\t    var count = 0;\n\t\t\t    if (qrCode.isDark(row,     col    ) ) count++;\n\t\t\t    if (qrCode.isDark(row + 1, col    ) ) count++;\n\t\t\t    if (qrCode.isDark(row,     col + 1) ) count++;\n\t\t\t    if (qrCode.isDark(row + 1, col + 1) ) count++;\n\t\t\t    if (count == 0 || count == 4) {\n\t\t\t\t    lostPoint += 3;\n\t\t\t    }\n\t\t    }\n\t    }\n\n\t    // LEVEL3\n\n\t    for (var row = 0; row < moduleCount; row++) {\n\t\t    for (var col = 0; col < moduleCount - 6; col++) {\n\t\t\t    if (qrCode.isDark(row, col)\n\t\t\t\t\t    && !qrCode.isDark(row, col + 1)\n\t\t\t\t\t    &&  qrCode.isDark(row, col + 2)\n\t\t\t\t\t    &&  qrCode.isDark(row, col + 3)\n\t\t\t\t\t    &&  qrCode.isDark(row, col + 4)\n\t\t\t\t\t    && !qrCode.isDark(row, col + 5)\n\t\t\t\t\t    &&  qrCode.isDark(row, col + 6) ) {\n\t\t\t\t    lostPoint += 40;\n\t\t\t    }\n\t\t    }\n\t    }\n\n\t    for (var col = 0; col < moduleCount; col++) {\n\t\t    for (var row = 0; row < moduleCount - 6; row++) {\n\t\t\t    if (qrCode.isDark(row, col)\n\t\t\t\t\t    && !qrCode.isDark(row + 1, col)\n\t\t\t\t\t    &&  qrCode.isDark(row + 2, col)\n\t\t\t\t\t    &&  qrCode.isDark(row + 3, col)\n\t\t\t\t\t    &&  qrCode.isDark(row + 4, col)\n\t\t\t\t\t    && !qrCode.isDark(row + 5, col)\n\t\t\t\t\t    &&  qrCode.isDark(row + 6, col) ) {\n\t\t\t\t    lostPoint += 40;\n\t\t\t    }\n\t\t    }\n\t    }\n\n\t    // LEVEL4\n\t    \n\t    var darkCount = 0;\n\n\t    for (var col = 0; col < moduleCount; col++) {\n\t\t    for (var row = 0; row < moduleCount; row++) {\n\t\t\t    if (qrCode.isDark(row, col) ) {\n\t\t\t\t    darkCount++;\n\t\t\t    }\n\t\t    }\n\t    }\n\t    \n\t    var ratio = Math.abs(100 * darkCount / moduleCount / moduleCount - 50) / 5;\n\t    lostPoint += ratio * 10;\n\n\t    return lostPoint;\t\t\n    }\n};\n\nmodule.exports = QRUtil;\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\n\nfunction fixStatsType(stat) {\n  return {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  }[stat.type] || stat.type;\n}\n\nfunction writeMediaSection(transceiver, caps, type, stream, dtlsRole) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : dtlsRole || 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    var trackId = transceiver.rtpSender._initialTrackId ||\n        transceiver.rtpSender.track.id;\n    transceiver.rtpSender._initialTrackId = trackId;\n    // spec.\n    var msid = 'msid:' + (stream ? stream.id : '-') + ' ' +\n        trackId + '\\r\\n';\n    sdp += 'a=' + msid;\n    // for Chrome. Legacy should no longer be required.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n\n    // RTX\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n}\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function(server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function(url) {\n        var validTurn = url.indexOf('turn:') === 0 &&\n            url.indexOf('transport=udp') !== -1 &&\n            url.indexOf('turn:[') === -1 &&\n            !hasTurn;\n\n        if (validTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&\n            url.indexOf('?transport=udp') === -1;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n\n// Determines the intersection of local and remote capabilities.\nfunction getCommonCapabilities(localCapabilities, remoteCapabilities) {\n  var commonCapabilities = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: []\n  };\n\n  var findCodecByPayloadType = function(pt, codecs) {\n    pt = parseInt(pt, 10);\n    for (var i = 0; i < codecs.length; i++) {\n      if (codecs[i].payloadType === pt ||\n          codecs[i].preferredPayloadType === pt) {\n        return codecs[i];\n      }\n    }\n  };\n\n  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {\n    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\n    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\n    return lCodec && rCodec &&\n        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();\n  };\n\n  localCapabilities.codecs.forEach(function(lCodec) {\n    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n      var rCodec = remoteCapabilities.codecs[i];\n      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n          lCodec.clockRate === rCodec.clockRate) {\n        if (lCodec.name.toLowerCase() === 'rtx' &&\n            lCodec.parameters && rCodec.parameters.apt) {\n          // for RTX we need to find the local rtx that has a apt\n          // which points to the same local codec as the remote one.\n          if (!rtxCapabilityMatches(lCodec, rCodec,\n              localCapabilities.codecs, remoteCapabilities.codecs)) {\n            continue;\n          }\n        }\n        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\n        // number of channels is the highest common number of channels\n        rCodec.numChannels = Math.min(lCodec.numChannels,\n            rCodec.numChannels);\n        // push rCodec so we reply with offerer payload type\n        commonCapabilities.codecs.push(rCodec);\n\n        // determine common feedback mechanisms\n        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n            if (lCodec.rtcpFeedback[j].type === fb.type &&\n                lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n              return true;\n            }\n          }\n          return false;\n        });\n        // FIXME: also need to determine .parameters\n        //  see https://github.com/openpeer/ortc/issues/569\n        break;\n      }\n    }\n  });\n\n  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {\n    for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n         i++) {\n      var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n      if (lHeaderExtension.uri === rHeaderExtension.uri) {\n        commonCapabilities.headerExtensions.push(rHeaderExtension);\n        break;\n      }\n    }\n  });\n\n  // FIXME: fecMechanisms\n  return commonCapabilities;\n}\n\n// is action=setLocalDescription with type allowed in signalingState\nfunction isActionAllowedInSignalingState(action, type, signalingState) {\n  return {\n    offer: {\n      setLocalDescription: ['stable', 'have-local-offer'],\n      setRemoteDescription: ['stable', 'have-remote-offer']\n    },\n    answer: {\n      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\n      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']\n    }\n  }[type][action].indexOf(signalingState) !== -1;\n}\n\nfunction maybeAddCandidate(iceTransport, candidate) {\n  // Edge's internal representation adds some fields therefore\n  // not all fieldѕ are taken into account.\n  var alreadyAdded = iceTransport.getRemoteCandidates()\n      .find(function(remoteCandidate) {\n        return candidate.foundation === remoteCandidate.foundation &&\n            candidate.ip === remoteCandidate.ip &&\n            candidate.port === remoteCandidate.port &&\n            candidate.priority === remoteCandidate.priority &&\n            candidate.protocol === remoteCandidate.protocol &&\n            candidate.type === remoteCandidate.type;\n      });\n  if (!alreadyAdded) {\n    iceTransport.addRemoteCandidate(candidate);\n  }\n  return !alreadyAdded;\n}\n\n\nfunction makeError(name, description) {\n  var e = new Error(description);\n  e.name = name;\n  // legacy error codes from https://heycam.github.io/webidl/#idl-DOMException-error-names\n  e.code = {\n    NotSupportedError: 9,\n    InvalidStateError: 11,\n    InvalidAccessError: 15,\n    TypeError: undefined,\n    OperationError: undefined\n  }[name];\n  return e;\n}\n\nmodule.exports = function(window, edgeVersion) {\n  // https://w3c.github.io/mediacapture-main/#mediastream\n  // Helper function to add the track to the stream and\n  // dispatch the event ourselves.\n  function addTrackToStreamAndFireEvent(track, stream) {\n    stream.addTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('addtrack',\n        {track: track}));\n  }\n\n  function removeTrackFromStreamAndFireEvent(track, stream) {\n    stream.removeTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('removetrack',\n        {track: track}));\n  }\n\n  function fireAddTrack(pc, track, receiver, streams) {\n    var trackEvent = new Event('track');\n    trackEvent.track = track;\n    trackEvent.receiver = receiver;\n    trackEvent.transceiver = {receiver: receiver};\n    trackEvent.streams = streams;\n    window.setTimeout(function() {\n      pc._dispatchEvent('track', trackEvent);\n    });\n  }\n\n  var RTCPeerConnection = function(config) {\n    var pc = this;\n\n    var _eventTarget = document.createDocumentFragment();\n    ['addEventListener', 'removeEventListener', 'dispatchEvent']\n        .forEach(function(method) {\n          pc[method] = _eventTarget[method].bind(_eventTarget);\n        });\n\n    this.canTrickleIceCandidates = null;\n\n    this.needNegotiation = false;\n\n    this.localStreams = [];\n    this.remoteStreams = [];\n\n    this._localDescription = null;\n    this._remoteDescription = null;\n\n    this.signalingState = 'stable';\n    this.iceConnectionState = 'new';\n    this.connectionState = 'new';\n    this.iceGatheringState = 'new';\n\n    config = JSON.parse(JSON.stringify(config || {}));\n\n    this.usingBundle = config.bundlePolicy === 'max-bundle';\n    if (config.rtcpMuxPolicy === 'negotiate') {\n      throw(makeError('NotSupportedError',\n          'rtcpMuxPolicy \\'negotiate\\' is not supported'));\n    } else if (!config.rtcpMuxPolicy) {\n      config.rtcpMuxPolicy = 'require';\n    }\n\n    switch (config.iceTransportPolicy) {\n      case 'all':\n      case 'relay':\n        break;\n      default:\n        config.iceTransportPolicy = 'all';\n        break;\n    }\n\n    switch (config.bundlePolicy) {\n      case 'balanced':\n      case 'max-compat':\n      case 'max-bundle':\n        break;\n      default:\n        config.bundlePolicy = 'balanced';\n        break;\n    }\n\n    config.iceServers = filterIceServers(config.iceServers || [], edgeVersion);\n\n    this._iceGatherers = [];\n    if (config.iceCandidatePoolSize) {\n      for (var i = config.iceCandidatePoolSize; i > 0; i--) {\n        this._iceGatherers.push(new window.RTCIceGatherer({\n          iceServers: config.iceServers,\n          gatherPolicy: config.iceTransportPolicy\n        }));\n      }\n    } else {\n      config.iceCandidatePoolSize = 0;\n    }\n\n    this._config = config;\n\n    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n    // everything that is needed to describe a SDP m-line.\n    this.transceivers = [];\n\n    this._sdpSessionId = SDPUtils.generateSessionId();\n    this._sdpSessionVersion = 0;\n\n    this._dtlsRole = undefined; // role for a=setup to use in answers.\n\n    this._isClosed = false;\n  };\n\n  Object.defineProperty(RTCPeerConnection.prototype, 'localDescription', {\n    configurable: true,\n    get: function() {\n      return this._localDescription;\n    }\n  });\n  Object.defineProperty(RTCPeerConnection.prototype, 'remoteDescription', {\n    configurable: true,\n    get: function() {\n      return this._remoteDescription;\n    }\n  });\n\n  // set up event handlers on prototype\n  RTCPeerConnection.prototype.onicecandidate = null;\n  RTCPeerConnection.prototype.onaddstream = null;\n  RTCPeerConnection.prototype.ontrack = null;\n  RTCPeerConnection.prototype.onremovestream = null;\n  RTCPeerConnection.prototype.onsignalingstatechange = null;\n  RTCPeerConnection.prototype.oniceconnectionstatechange = null;\n  RTCPeerConnection.prototype.onconnectionstatechange = null;\n  RTCPeerConnection.prototype.onicegatheringstatechange = null;\n  RTCPeerConnection.prototype.onnegotiationneeded = null;\n  RTCPeerConnection.prototype.ondatachannel = null;\n\n  RTCPeerConnection.prototype._dispatchEvent = function(name, event) {\n    if (this._isClosed) {\n      return;\n    }\n    this.dispatchEvent(event);\n    if (typeof this['on' + name] === 'function') {\n      this['on' + name](event);\n    }\n  };\n\n  RTCPeerConnection.prototype._emitGatheringStateChange = function() {\n    var event = new Event('icegatheringstatechange');\n    this._dispatchEvent('icegatheringstatechange', event);\n  };\n\n  RTCPeerConnection.prototype.getConfiguration = function() {\n    return this._config;\n  };\n\n  RTCPeerConnection.prototype.getLocalStreams = function() {\n    return this.localStreams;\n  };\n\n  RTCPeerConnection.prototype.getRemoteStreams = function() {\n    return this.remoteStreams;\n  };\n\n  // internal helper to create a transceiver object.\n  // (which is not yet the same as the WebRTC 1.0 transceiver)\n  RTCPeerConnection.prototype._createTransceiver = function(kind, doNotAdd) {\n    var hasBundleTransport = this.transceivers.length > 0;\n    var transceiver = {\n      track: null,\n      iceGatherer: null,\n      iceTransport: null,\n      dtlsTransport: null,\n      localCapabilities: null,\n      remoteCapabilities: null,\n      rtpSender: null,\n      rtpReceiver: null,\n      kind: kind,\n      mid: null,\n      sendEncodingParameters: null,\n      recvEncodingParameters: null,\n      stream: null,\n      associatedRemoteMediaStreams: [],\n      wantReceive: true\n    };\n    if (this.usingBundle && hasBundleTransport) {\n      transceiver.iceTransport = this.transceivers[0].iceTransport;\n      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\n    } else {\n      var transports = this._createIceAndDtlsTransports();\n      transceiver.iceTransport = transports.iceTransport;\n      transceiver.dtlsTransport = transports.dtlsTransport;\n    }\n    if (!doNotAdd) {\n      this.transceivers.push(transceiver);\n    }\n    return transceiver;\n  };\n\n  RTCPeerConnection.prototype.addTrack = function(track, stream) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call addTrack on a closed peerconnection.');\n    }\n\n    var alreadyExists = this.transceivers.find(function(s) {\n      return s.track === track;\n    });\n\n    if (alreadyExists) {\n      throw makeError('InvalidAccessError', 'Track already exists.');\n    }\n\n    var transceiver;\n    for (var i = 0; i < this.transceivers.length; i++) {\n      if (!this.transceivers[i].track &&\n          this.transceivers[i].kind === track.kind) {\n        transceiver = this.transceivers[i];\n      }\n    }\n    if (!transceiver) {\n      transceiver = this._createTransceiver(track.kind);\n    }\n\n    this._maybeFireNegotiationNeeded();\n\n    if (this.localStreams.indexOf(stream) === -1) {\n      this.localStreams.push(stream);\n    }\n\n    transceiver.track = track;\n    transceiver.stream = stream;\n    transceiver.rtpSender = new window.RTCRtpSender(track,\n        transceiver.dtlsTransport);\n    return transceiver.rtpSender;\n  };\n\n  RTCPeerConnection.prototype.addStream = function(stream) {\n    var pc = this;\n    if (edgeVersion >= 15025) {\n      stream.getTracks().forEach(function(track) {\n        pc.addTrack(track, stream);\n      });\n    } else {\n      // Clone is necessary for local demos mostly, attaching directly\n      // to two different senders does not work (build 10547).\n      // Fixed in 15025 (or earlier)\n      var clonedStream = stream.clone();\n      stream.getTracks().forEach(function(track, idx) {\n        var clonedTrack = clonedStream.getTracks()[idx];\n        track.addEventListener('enabled', function(event) {\n          clonedTrack.enabled = event.enabled;\n        });\n      });\n      clonedStream.getTracks().forEach(function(track) {\n        pc.addTrack(track, clonedStream);\n      });\n    }\n  };\n\n  RTCPeerConnection.prototype.removeTrack = function(sender) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call removeTrack on a closed peerconnection.');\n    }\n\n    if (!(sender instanceof window.RTCRtpSender)) {\n      throw new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +\n          'does not implement interface RTCRtpSender.');\n    }\n\n    var transceiver = this.transceivers.find(function(t) {\n      return t.rtpSender === sender;\n    });\n\n    if (!transceiver) {\n      throw makeError('InvalidAccessError',\n          'Sender was not created by this connection.');\n    }\n    var stream = transceiver.stream;\n\n    transceiver.rtpSender.stop();\n    transceiver.rtpSender = null;\n    transceiver.track = null;\n    transceiver.stream = null;\n\n    // remove the stream from the set of local streams\n    var localStreams = this.transceivers.map(function(t) {\n      return t.stream;\n    });\n    if (localStreams.indexOf(stream) === -1 &&\n        this.localStreams.indexOf(stream) > -1) {\n      this.localStreams.splice(this.localStreams.indexOf(stream), 1);\n    }\n\n    this._maybeFireNegotiationNeeded();\n  };\n\n  RTCPeerConnection.prototype.removeStream = function(stream) {\n    var pc = this;\n    stream.getTracks().forEach(function(track) {\n      var sender = pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n      if (sender) {\n        pc.removeTrack(sender);\n      }\n    });\n  };\n\n  RTCPeerConnection.prototype.getSenders = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpSender;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpSender;\n    });\n  };\n\n  RTCPeerConnection.prototype.getReceivers = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpReceiver;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpReceiver;\n    });\n  };\n\n\n  RTCPeerConnection.prototype._createIceGatherer = function(sdpMLineIndex,\n      usingBundle) {\n    var pc = this;\n    if (usingBundle && sdpMLineIndex > 0) {\n      return this.transceivers[0].iceGatherer;\n    } else if (this._iceGatherers.length) {\n      return this._iceGatherers.shift();\n    }\n    var iceGatherer = new window.RTCIceGatherer({\n      iceServers: this._config.iceServers,\n      gatherPolicy: this._config.iceTransportPolicy\n    });\n    Object.defineProperty(iceGatherer, 'state',\n        {value: 'new', writable: true}\n    );\n\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = [];\n    this.transceivers[sdpMLineIndex].bufferCandidates = function(event) {\n      var end = !event.candidate || Object.keys(event.candidate).length === 0;\n      // polyfill since RTCIceGatherer.state is not implemented in\n      // Edge 10547 yet.\n      iceGatherer.state = end ? 'completed' : 'gathering';\n      if (pc.transceivers[sdpMLineIndex].bufferedCandidateEvents !== null) {\n        pc.transceivers[sdpMLineIndex].bufferedCandidateEvents.push(event);\n      }\n    };\n    iceGatherer.addEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    return iceGatherer;\n  };\n\n  // start gathering from an RTCIceGatherer.\n  RTCPeerConnection.prototype._gather = function(mid, sdpMLineIndex) {\n    var pc = this;\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer.onlocalcandidate) {\n      return;\n    }\n    var bufferedCandidateEvents =\n      this.transceivers[sdpMLineIndex].bufferedCandidateEvents;\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = null;\n    iceGatherer.removeEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    iceGatherer.onlocalcandidate = function(evt) {\n      if (pc.usingBundle && sdpMLineIndex > 0) {\n        // if we know that we use bundle we can drop candidates with\n        // ѕdpMLineIndex > 0. If we don't do this then our state gets\n        // confused since we dispose the extra ice gatherer.\n        return;\n      }\n      var event = new Event('icecandidate');\n      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n\n      var cand = evt.candidate;\n      // Edge emits an empty object for RTCIceCandidateComplete‥\n      var end = !cand || Object.keys(cand).length === 0;\n      if (end) {\n        // polyfill since RTCIceGatherer.state is not implemented in\n        // Edge 10547 yet.\n        if (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {\n          iceGatherer.state = 'completed';\n        }\n      } else {\n        if (iceGatherer.state === 'new') {\n          iceGatherer.state = 'gathering';\n        }\n        // RTCIceCandidate doesn't have a component, needs to be added\n        cand.component = 1;\n        // also the usernameFragment. TODO: update SDP to take both variants.\n        cand.ufrag = iceGatherer.getLocalParameters().usernameFragment;\n\n        var serializedCandidate = SDPUtils.writeCandidate(cand);\n        event.candidate = Object.assign(event.candidate,\n            SDPUtils.parseCandidate(serializedCandidate));\n\n        event.candidate.candidate = serializedCandidate;\n        event.candidate.toJSON = function() {\n          return {\n            candidate: event.candidate.candidate,\n            sdpMid: event.candidate.sdpMid,\n            sdpMLineIndex: event.candidate.sdpMLineIndex,\n            usernameFragment: event.candidate.usernameFragment\n          };\n        };\n      }\n\n      // update local description.\n      var sections = SDPUtils.getMediaSections(pc._localDescription.sdp);\n      if (!end) {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      } else {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=end-of-candidates\\r\\n';\n      }\n      pc._localDescription.sdp =\n          SDPUtils.getDescription(pc._localDescription.sdp) +\n          sections.join('');\n      var complete = pc.transceivers.every(function(transceiver) {\n        return transceiver.iceGatherer &&\n            transceiver.iceGatherer.state === 'completed';\n      });\n\n      if (pc.iceGatheringState !== 'gathering') {\n        pc.iceGatheringState = 'gathering';\n        pc._emitGatheringStateChange();\n      }\n\n      // Emit candidate. Also emit null candidate when all gatherers are\n      // complete.\n      if (!end) {\n        pc._dispatchEvent('icecandidate', event);\n      }\n      if (complete) {\n        pc._dispatchEvent('icecandidate', new Event('icecandidate'));\n        pc.iceGatheringState = 'complete';\n        pc._emitGatheringStateChange();\n      }\n    };\n\n    // emit already gathered candidates.\n    window.setTimeout(function() {\n      bufferedCandidateEvents.forEach(function(e) {\n        iceGatherer.onlocalcandidate(e);\n      });\n    }, 0);\n  };\n\n  // Create ICE transport and DTLS transport.\n  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {\n    var pc = this;\n    var iceTransport = new window.RTCIceTransport(null);\n    iceTransport.onicestatechange = function() {\n      pc._updateIceConnectionState();\n      pc._updateConnectionState();\n    };\n\n    var dtlsTransport = new window.RTCDtlsTransport(iceTransport);\n    dtlsTransport.ondtlsstatechange = function() {\n      pc._updateConnectionState();\n    };\n    dtlsTransport.onerror = function() {\n      // onerror does not set state to failed by itself.\n      Object.defineProperty(dtlsTransport, 'state',\n          {value: 'failed', writable: true});\n      pc._updateConnectionState();\n    };\n\n    return {\n      iceTransport: iceTransport,\n      dtlsTransport: dtlsTransport\n    };\n  };\n\n  // Destroy ICE gatherer, ICE transport and DTLS transport.\n  // Without triggering the callbacks.\n  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(\n      sdpMLineIndex) {\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer) {\n      delete iceGatherer.onlocalcandidate;\n      delete this.transceivers[sdpMLineIndex].iceGatherer;\n    }\n    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\n    if (iceTransport) {\n      delete iceTransport.onicestatechange;\n      delete this.transceivers[sdpMLineIndex].iceTransport;\n    }\n    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\n    if (dtlsTransport) {\n      delete dtlsTransport.ondtlsstatechange;\n      delete dtlsTransport.onerror;\n      delete this.transceivers[sdpMLineIndex].dtlsTransport;\n    }\n  };\n\n  // Start the RTP Sender and Receiver for a transceiver.\n  RTCPeerConnection.prototype._transceive = function(transceiver,\n      send, recv) {\n    var params = getCommonCapabilities(transceiver.localCapabilities,\n        transceiver.remoteCapabilities);\n    if (send && transceiver.rtpSender) {\n      params.encodings = transceiver.sendEncodingParameters;\n      params.rtcp = {\n        cname: SDPUtils.localCName,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.recvEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpSender.send(params);\n    }\n    if (recv && transceiver.rtpReceiver && params.codecs.length > 0) {\n      // remove RTX field in Edge 14942\n      if (transceiver.kind === 'video'\n          && transceiver.recvEncodingParameters\n          && edgeVersion < 15019) {\n        transceiver.recvEncodingParameters.forEach(function(p) {\n          delete p.rtx;\n        });\n      }\n      if (transceiver.recvEncodingParameters.length) {\n        params.encodings = transceiver.recvEncodingParameters;\n      } else {\n        params.encodings = [{}];\n      }\n      params.rtcp = {\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.rtcpParameters.cname) {\n        params.rtcp.cname = transceiver.rtcpParameters.cname;\n      }\n      if (transceiver.sendEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpReceiver.receive(params);\n    }\n  };\n\n  RTCPeerConnection.prototype.setLocalDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setLocalDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set local ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var sections;\n    var sessionpart;\n    if (description.type === 'offer') {\n      // VERY limited support for SDP munging. Limited to:\n      // * changing the order of codecs\n      sections = SDPUtils.splitSections(description.sdp);\n      sessionpart = sections.shift();\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var caps = SDPUtils.parseRtpParameters(mediaSection);\n        pc.transceivers[sdpMLineIndex].localCapabilities = caps;\n      });\n\n      pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n        pc._gather(transceiver.mid, sdpMLineIndex);\n      });\n    } else if (description.type === 'answer') {\n      sections = SDPUtils.splitSections(pc._remoteDescription.sdp);\n      sessionpart = sections.shift();\n      var isIceLite = SDPUtils.matchPrefix(sessionpart,\n          'a=ice-lite').length > 0;\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        var iceGatherer = transceiver.iceGatherer;\n        var iceTransport = transceiver.iceTransport;\n        var dtlsTransport = transceiver.dtlsTransport;\n        var localCapabilities = transceiver.localCapabilities;\n        var remoteCapabilities = transceiver.remoteCapabilities;\n\n        // treat bundle-only as not-rejected.\n        var rejected = SDPUtils.isRejected(mediaSection) &&\n            SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n\n        if (!rejected && !transceiver.rejected) {\n          var remoteIceParameters = SDPUtils.getIceParameters(\n              mediaSection, sessionpart);\n          var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n              mediaSection, sessionpart);\n          if (isIceLite) {\n            remoteDtlsParameters.role = 'server';\n          }\n\n          if (!pc.usingBundle || sdpMLineIndex === 0) {\n            pc._gather(transceiver.mid, sdpMLineIndex);\n            if (iceTransport.state === 'new') {\n              iceTransport.start(iceGatherer, remoteIceParameters,\n                  isIceLite ? 'controlling' : 'controlled');\n            }\n            if (dtlsTransport.state === 'new') {\n              dtlsTransport.start(remoteDtlsParameters);\n            }\n          }\n\n          // Calculate intersection of capabilities.\n          var params = getCommonCapabilities(localCapabilities,\n              remoteCapabilities);\n\n          // Start the RTCRtpSender. The RTCRtpReceiver for this\n          // transceiver has already been started in setRemoteDescription.\n          pc._transceive(transceiver,\n              params.codecs.length > 0,\n              false);\n        }\n      });\n    }\n\n    pc._localDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-local-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.setRemoteDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setRemoteDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set remote ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var streams = {};\n    pc.remoteStreams.forEach(function(stream) {\n      streams[stream.id] = stream;\n    });\n    var receiverList = [];\n    var sections = SDPUtils.splitSections(description.sdp);\n    var sessionpart = sections.shift();\n    var isIceLite = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-lite').length > 0;\n    var usingBundle = SDPUtils.matchPrefix(sessionpart,\n        'a=group:BUNDLE ').length > 0;\n    pc.usingBundle = usingBundle;\n    var iceOptions = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-options:')[0];\n    if (iceOptions) {\n      pc.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\n          .indexOf('trickle') >= 0;\n    } else {\n      pc.canTrickleIceCandidates = false;\n    }\n\n    sections.forEach(function(mediaSection, sdpMLineIndex) {\n      var lines = SDPUtils.splitLines(mediaSection);\n      var kind = SDPUtils.getKind(mediaSection);\n      // treat bundle-only as not-rejected.\n      var rejected = SDPUtils.isRejected(mediaSection) &&\n          SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n      var protocol = lines[0].substr(2).split(' ')[2];\n\n      var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n      var remoteMsid = SDPUtils.parseMsid(mediaSection);\n\n      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\n\n      // Reject datachannels which are not implemented yet.\n      if (rejected || (kind === 'application' && (protocol === 'DTLS/SCTP' ||\n          protocol === 'UDP/DTLS/SCTP'))) {\n        // TODO: this is dangerous in the case where a non-rejected m-line\n        //     becomes rejected.\n        pc.transceivers[sdpMLineIndex] = {\n          mid: mid,\n          kind: kind,\n          protocol: protocol,\n          rejected: true\n        };\n        return;\n      }\n\n      if (!rejected && pc.transceivers[sdpMLineIndex] &&\n          pc.transceivers[sdpMLineIndex].rejected) {\n        // recycle a rejected transceiver.\n        pc.transceivers[sdpMLineIndex] = pc._createTransceiver(kind, true);\n      }\n\n      var transceiver;\n      var iceGatherer;\n      var iceTransport;\n      var dtlsTransport;\n      var rtpReceiver;\n      var sendEncodingParameters;\n      var recvEncodingParameters;\n      var localCapabilities;\n\n      var track;\n      // FIXME: ensure the mediaSection has rtcp-mux set.\n      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n      var remoteIceParameters;\n      var remoteDtlsParameters;\n      if (!rejected) {\n        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters.role = 'client';\n      }\n      recvEncodingParameters =\n          SDPUtils.parseRtpEncodingParameters(mediaSection);\n\n      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\n\n      var isComplete = SDPUtils.matchPrefix(mediaSection,\n          'a=end-of-candidates', sessionpart).length > 0;\n      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n          .map(function(cand) {\n            return SDPUtils.parseCandidate(cand);\n          })\n          .filter(function(cand) {\n            return cand.component === 1;\n          });\n\n      // Check if we can use BUNDLE and dispose transports.\n      if ((description.type === 'offer' || description.type === 'answer') &&\n          !rejected && usingBundle && sdpMLineIndex > 0 &&\n          pc.transceivers[sdpMLineIndex]) {\n        pc._disposeIceAndDtlsTransports(sdpMLineIndex);\n        pc.transceivers[sdpMLineIndex].iceGatherer =\n            pc.transceivers[0].iceGatherer;\n        pc.transceivers[sdpMLineIndex].iceTransport =\n            pc.transceivers[0].iceTransport;\n        pc.transceivers[sdpMLineIndex].dtlsTransport =\n            pc.transceivers[0].dtlsTransport;\n        if (pc.transceivers[sdpMLineIndex].rtpSender) {\n          pc.transceivers[sdpMLineIndex].rtpSender.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n        if (pc.transceivers[sdpMLineIndex].rtpReceiver) {\n          pc.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n      }\n      if (description.type === 'offer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex] ||\n            pc._createTransceiver(kind);\n        transceiver.mid = mid;\n\n        if (!transceiver.iceGatherer) {\n          transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n              usingBundle);\n        }\n\n        if (cands.length && transceiver.iceTransport.state === 'new') {\n          if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\n            transceiver.iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        localCapabilities = window.RTCRtpReceiver.getCapabilities(kind);\n\n        // filter RTX until additional stuff needed for RTX is implemented\n        // in adapter.js\n        if (edgeVersion < 15019) {\n          localCapabilities.codecs = localCapabilities.codecs.filter(\n              function(codec) {\n                return codec.name !== 'rtx';\n              });\n        }\n\n        sendEncodingParameters = transceiver.sendEncodingParameters || [{\n          ssrc: (2 * sdpMLineIndex + 2) * 1001\n        }];\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        var isNewTrack = false;\n        if (direction === 'sendrecv' || direction === 'sendonly') {\n          isNewTrack = !transceiver.rtpReceiver;\n          rtpReceiver = transceiver.rtpReceiver ||\n              new window.RTCRtpReceiver(transceiver.dtlsTransport, kind);\n\n          if (isNewTrack) {\n            var stream;\n            track = rtpReceiver.track;\n            // FIXME: does not work with Plan B.\n            if (remoteMsid && remoteMsid.stream === '-') {\n              // no-op. a stream id of '-' means: no associated stream.\n            } else if (remoteMsid) {\n              if (!streams[remoteMsid.stream]) {\n                streams[remoteMsid.stream] = new window.MediaStream();\n                Object.defineProperty(streams[remoteMsid.stream], 'id', {\n                  get: function() {\n                    return remoteMsid.stream;\n                  }\n                });\n              }\n              Object.defineProperty(track, 'id', {\n                get: function() {\n                  return remoteMsid.track;\n                }\n              });\n              stream = streams[remoteMsid.stream];\n            } else {\n              if (!streams.default) {\n                streams.default = new window.MediaStream();\n              }\n              stream = streams.default;\n            }\n            if (stream) {\n              addTrackToStreamAndFireEvent(track, stream);\n              transceiver.associatedRemoteMediaStreams.push(stream);\n            }\n            receiverList.push([track, rtpReceiver, stream]);\n          }\n        } else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {\n          transceiver.associatedRemoteMediaStreams.forEach(function(s) {\n            var nativeTrack = s.getTracks().find(function(t) {\n              return t.id === transceiver.rtpReceiver.track.id;\n            });\n            if (nativeTrack) {\n              removeTrackFromStreamAndFireEvent(nativeTrack, s);\n            }\n          });\n          transceiver.associatedRemoteMediaStreams = [];\n        }\n\n        transceiver.localCapabilities = localCapabilities;\n        transceiver.remoteCapabilities = remoteCapabilities;\n        transceiver.rtpReceiver = rtpReceiver;\n        transceiver.rtcpParameters = rtcpParameters;\n        transceiver.sendEncodingParameters = sendEncodingParameters;\n        transceiver.recvEncodingParameters = recvEncodingParameters;\n\n        // Start the RTCRtpReceiver now. The RTPSender is started in\n        // setLocalDescription.\n        pc._transceive(pc.transceivers[sdpMLineIndex],\n            false,\n            isNewTrack);\n      } else if (description.type === 'answer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex];\n        iceGatherer = transceiver.iceGatherer;\n        iceTransport = transceiver.iceTransport;\n        dtlsTransport = transceiver.dtlsTransport;\n        rtpReceiver = transceiver.rtpReceiver;\n        sendEncodingParameters = transceiver.sendEncodingParameters;\n        localCapabilities = transceiver.localCapabilities;\n\n        pc.transceivers[sdpMLineIndex].recvEncodingParameters =\n            recvEncodingParameters;\n        pc.transceivers[sdpMLineIndex].remoteCapabilities =\n            remoteCapabilities;\n        pc.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\n\n        if (cands.length && iceTransport.state === 'new') {\n          if ((isIceLite || isComplete) &&\n              (!usingBundle || sdpMLineIndex === 0)) {\n            iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        if (!usingBundle || sdpMLineIndex === 0) {\n          if (iceTransport.state === 'new') {\n            iceTransport.start(iceGatherer, remoteIceParameters,\n                'controlling');\n          }\n          if (dtlsTransport.state === 'new') {\n            dtlsTransport.start(remoteDtlsParameters);\n          }\n        }\n\n        // If the offer contained RTX but the answer did not,\n        // remove RTX from sendEncodingParameters.\n        var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n        var hasRtx = commonCapabilities.codecs.filter(function(c) {\n          return c.name.toLowerCase() === 'rtx';\n        }).length;\n        if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n          delete transceiver.sendEncodingParameters[0].rtx;\n        }\n\n        pc._transceive(transceiver,\n            direction === 'sendrecv' || direction === 'recvonly',\n            direction === 'sendrecv' || direction === 'sendonly');\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        if (rtpReceiver &&\n            (direction === 'sendrecv' || direction === 'sendonly')) {\n          track = rtpReceiver.track;\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);\n            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams.default);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        } else {\n          // FIXME: actually the receiver should be created later.\n          delete transceiver.rtpReceiver;\n        }\n      }\n    });\n\n    if (pc._dtlsRole === undefined) {\n      pc._dtlsRole = description.type === 'offer' ? 'active' : 'passive';\n    }\n\n    pc._remoteDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-remote-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n    Object.keys(streams).forEach(function(sid) {\n      var stream = streams[sid];\n      if (stream.getTracks().length) {\n        if (pc.remoteStreams.indexOf(stream) === -1) {\n          pc.remoteStreams.push(stream);\n          var event = new Event('addstream');\n          event.stream = stream;\n          window.setTimeout(function() {\n            pc._dispatchEvent('addstream', event);\n          });\n        }\n\n        receiverList.forEach(function(item) {\n          var track = item[0];\n          var receiver = item[1];\n          if (stream.id !== item[2].id) {\n            return;\n          }\n          fireAddTrack(pc, track, receiver, [stream]);\n        });\n      }\n    });\n    receiverList.forEach(function(item) {\n      if (item[2]) {\n        return;\n      }\n      fireAddTrack(pc, item[0], item[1], []);\n    });\n\n    // check whether addIceCandidate({}) was called within four seconds after\n    // setRemoteDescription.\n    window.setTimeout(function() {\n      if (!(pc && pc.transceivers)) {\n        return;\n      }\n      pc.transceivers.forEach(function(transceiver) {\n        if (transceiver.iceTransport &&\n            transceiver.iceTransport.state === 'new' &&\n            transceiver.iceTransport.getRemoteCandidates().length > 0) {\n          console.warn('Timeout for addRemoteCandidate. Consider sending ' +\n              'an end-of-candidates notification');\n          transceiver.iceTransport.addRemoteCandidate({});\n        }\n      });\n    }, 4000);\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.close = function() {\n    this.transceivers.forEach(function(transceiver) {\n      /* not yet\n      if (transceiver.iceGatherer) {\n        transceiver.iceGatherer.close();\n      }\n      */\n      if (transceiver.iceTransport) {\n        transceiver.iceTransport.stop();\n      }\n      if (transceiver.dtlsTransport) {\n        transceiver.dtlsTransport.stop();\n      }\n      if (transceiver.rtpSender) {\n        transceiver.rtpSender.stop();\n      }\n      if (transceiver.rtpReceiver) {\n        transceiver.rtpReceiver.stop();\n      }\n    });\n    // FIXME: clean up tracks, local streams, remote streams, etc\n    this._isClosed = true;\n    this._updateSignalingState('closed');\n  };\n\n  // Update the signaling state.\n  RTCPeerConnection.prototype._updateSignalingState = function(newState) {\n    this.signalingState = newState;\n    var event = new Event('signalingstatechange');\n    this._dispatchEvent('signalingstatechange', event);\n  };\n\n  // Determine whether to fire the negotiationneeded event.\n  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {\n    var pc = this;\n    if (this.signalingState !== 'stable' || this.needNegotiation === true) {\n      return;\n    }\n    this.needNegotiation = true;\n    window.setTimeout(function() {\n      if (pc.needNegotiation) {\n        pc.needNegotiation = false;\n        var event = new Event('negotiationneeded');\n        pc._dispatchEvent('negotiationneeded', event);\n      }\n    }, 0);\n  };\n\n  // Update the ice connection state.\n  RTCPeerConnection.prototype._updateIceConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      checking: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n      }\n    });\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.checking > 0) {\n      newState = 'checking';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    } else if (states.completed > 0) {\n      newState = 'completed';\n    }\n\n    if (newState !== this.iceConnectionState) {\n      this.iceConnectionState = newState;\n      var event = new Event('iceconnectionstatechange');\n      this._dispatchEvent('iceconnectionstatechange', event);\n    }\n  };\n\n  // Update the connection state.\n  RTCPeerConnection.prototype._updateConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      connecting: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && transceiver.dtlsTransport &&\n          !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n        states[transceiver.dtlsTransport.state]++;\n      }\n    });\n    // ICETransport.completed and connected are the same for this purpose.\n    states.connected += states.completed;\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.connecting > 0) {\n      newState = 'connecting';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    }\n\n    if (newState !== this.connectionState) {\n      this.connectionState = newState;\n      var event = new Event('connectionstatechange');\n      this._dispatchEvent('connectionstatechange', event);\n    }\n  };\n\n  RTCPeerConnection.prototype.createOffer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createOffer after close'));\n    }\n\n    var numAudioTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'audio';\n    }).length;\n    var numVideoTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'video';\n    }).length;\n\n    // Determine number of audio and video tracks we need to send/recv.\n    var offerOptions = arguments[0];\n    if (offerOptions) {\n      // Reject Chrome legacy constraints.\n      if (offerOptions.mandatory || offerOptions.optional) {\n        throw new TypeError(\n            'Legacy mandatory/optional constraints not supported.');\n      }\n      if (offerOptions.offerToReceiveAudio !== undefined) {\n        if (offerOptions.offerToReceiveAudio === true) {\n          numAudioTracks = 1;\n        } else if (offerOptions.offerToReceiveAudio === false) {\n          numAudioTracks = 0;\n        } else {\n          numAudioTracks = offerOptions.offerToReceiveAudio;\n        }\n      }\n      if (offerOptions.offerToReceiveVideo !== undefined) {\n        if (offerOptions.offerToReceiveVideo === true) {\n          numVideoTracks = 1;\n        } else if (offerOptions.offerToReceiveVideo === false) {\n          numVideoTracks = 0;\n        } else {\n          numVideoTracks = offerOptions.offerToReceiveVideo;\n        }\n      }\n    }\n\n    pc.transceivers.forEach(function(transceiver) {\n      if (transceiver.kind === 'audio') {\n        numAudioTracks--;\n        if (numAudioTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      } else if (transceiver.kind === 'video') {\n        numVideoTracks--;\n        if (numVideoTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      }\n    });\n\n    // Create M-lines for recvonly streams.\n    while (numAudioTracks > 0 || numVideoTracks > 0) {\n      if (numAudioTracks > 0) {\n        pc._createTransceiver('audio');\n        numAudioTracks--;\n      }\n      if (numVideoTracks > 0) {\n        pc._createTransceiver('video');\n        numVideoTracks--;\n      }\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      // For each track, create an ice gatherer, ice transport,\n      // dtls transport, potentially rtpsender and rtpreceiver.\n      var track = transceiver.track;\n      var kind = transceiver.kind;\n      var mid = transceiver.mid || SDPUtils.generateIdentifier();\n      transceiver.mid = mid;\n\n      if (!transceiver.iceGatherer) {\n        transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n            pc.usingBundle);\n      }\n\n      var localCapabilities = window.RTCRtpSender.getCapabilities(kind);\n      // filter RTX until additional stuff needed for RTX is implemented\n      // in adapter.js\n      if (edgeVersion < 15019) {\n        localCapabilities.codecs = localCapabilities.codecs.filter(\n            function(codec) {\n              return codec.name !== 'rtx';\n            });\n      }\n      localCapabilities.codecs.forEach(function(codec) {\n        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n        // by adding level-asymmetry-allowed=1\n        if (codec.name === 'H264' &&\n            codec.parameters['level-asymmetry-allowed'] === undefined) {\n          codec.parameters['level-asymmetry-allowed'] = '1';\n        }\n\n        // for subsequent offers, we might have to re-use the payload\n        // type of the last offer.\n        if (transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.codecs) {\n          transceiver.remoteCapabilities.codecs.forEach(function(remoteCodec) {\n            if (codec.name.toLowerCase() === remoteCodec.name.toLowerCase() &&\n                codec.clockRate === remoteCodec.clockRate) {\n              codec.preferredPayloadType = remoteCodec.payloadType;\n            }\n          });\n        }\n      });\n      localCapabilities.headerExtensions.forEach(function(hdrExt) {\n        var remoteExtensions = transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.headerExtensions || [];\n        remoteExtensions.forEach(function(rHdrExt) {\n          if (hdrExt.uri === rHdrExt.uri) {\n            hdrExt.id = rHdrExt.id;\n          }\n        });\n      });\n\n      // generate an ssrc now, to be used later in rtpSender.send\n      var sendEncodingParameters = transceiver.sendEncodingParameters || [{\n        ssrc: (2 * sdpMLineIndex + 1) * 1001\n      }];\n      if (track) {\n        // add RTX\n        if (edgeVersion >= 15019 && kind === 'video' &&\n            !sendEncodingParameters[0].rtx) {\n          sendEncodingParameters[0].rtx = {\n            ssrc: sendEncodingParameters[0].ssrc + 1\n          };\n        }\n      }\n\n      if (transceiver.wantReceive) {\n        transceiver.rtpReceiver = new window.RTCRtpReceiver(\n            transceiver.dtlsTransport, kind);\n      }\n\n      transceiver.localCapabilities = localCapabilities;\n      transceiver.sendEncodingParameters = sendEncodingParameters;\n    });\n\n    // always offer BUNDLE and dispose on return if not supported.\n    if (pc._config.bundlePolicy !== 'max-compat') {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      sdp += writeMediaSection(transceiver, transceiver.localCapabilities,\n          'offer', transceiver.stream, pc._dtlsRole);\n      sdp += 'a=rtcp-rsize\\r\\n';\n\n      if (transceiver.iceGatherer && pc.iceGatheringState !== 'new' &&\n          (sdpMLineIndex === 0 || !pc.usingBundle)) {\n        transceiver.iceGatherer.getLocalCandidates().forEach(function(cand) {\n          cand.component = 1;\n          sdp += 'a=' + SDPUtils.writeCandidate(cand) + '\\r\\n';\n        });\n\n        if (transceiver.iceGatherer.state === 'completed') {\n          sdp += 'a=end-of-candidates\\r\\n';\n        }\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'offer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.createAnswer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer after close'));\n    }\n\n    if (!(pc.signalingState === 'have-remote-offer' ||\n        pc.signalingState === 'have-local-pranswer')) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer in signalingState ' + pc.signalingState));\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    if (pc.usingBundle) {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    var mediaSectionsInOffer = SDPUtils.getMediaSections(\n        pc._remoteDescription.sdp).length;\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      if (sdpMLineIndex + 1 > mediaSectionsInOffer) {\n        return;\n      }\n      if (transceiver.rejected) {\n        if (transceiver.kind === 'application') {\n          if (transceiver.protocol === 'DTLS/SCTP') { // legacy fmt\n            sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n';\n          } else {\n            sdp += 'm=application 0 ' + transceiver.protocol +\n                ' webrtc-datachannel\\r\\n';\n          }\n        } else if (transceiver.kind === 'audio') {\n          sdp += 'm=audio 0 UDP/TLS/RTP/SAVPF 0\\r\\n' +\n              'a=rtpmap:0 PCMU/8000\\r\\n';\n        } else if (transceiver.kind === 'video') {\n          sdp += 'm=video 0 UDP/TLS/RTP/SAVPF 120\\r\\n' +\n              'a=rtpmap:120 VP8/90000\\r\\n';\n        }\n        sdp += 'c=IN IP4 0.0.0.0\\r\\n' +\n            'a=inactive\\r\\n' +\n            'a=mid:' + transceiver.mid + '\\r\\n';\n        return;\n      }\n\n      // FIXME: look at direction.\n      if (transceiver.stream) {\n        var localTrack;\n        if (transceiver.kind === 'audio') {\n          localTrack = transceiver.stream.getAudioTracks()[0];\n        } else if (transceiver.kind === 'video') {\n          localTrack = transceiver.stream.getVideoTracks()[0];\n        }\n        if (localTrack) {\n          // add RTX\n          if (edgeVersion >= 15019 && transceiver.kind === 'video' &&\n              !transceiver.sendEncodingParameters[0].rtx) {\n            transceiver.sendEncodingParameters[0].rtx = {\n              ssrc: transceiver.sendEncodingParameters[0].ssrc + 1\n            };\n          }\n        }\n      }\n\n      // Calculate intersection of capabilities.\n      var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n      var hasRtx = commonCapabilities.codecs.filter(function(c) {\n        return c.name.toLowerCase() === 'rtx';\n      }).length;\n      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n        delete transceiver.sendEncodingParameters[0].rtx;\n      }\n\n      sdp += writeMediaSection(transceiver, commonCapabilities,\n          'answer', transceiver.stream, pc._dtlsRole);\n      if (transceiver.rtcpParameters &&\n          transceiver.rtcpParameters.reducedSize) {\n        sdp += 'a=rtcp-rsize\\r\\n';\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'answer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n    var pc = this;\n    var sections;\n    if (candidate && !(candidate.sdpMLineIndex !== undefined ||\n        candidate.sdpMid)) {\n      return Promise.reject(new TypeError('sdpMLineIndex or sdpMid required'));\n    }\n\n    // TODO: needs to go into ops queue.\n    return new Promise(function(resolve, reject) {\n      if (!pc._remoteDescription) {\n        return reject(makeError('InvalidStateError',\n            'Can not add ICE candidate without a remote description'));\n      } else if (!candidate || candidate.candidate === '') {\n        for (var j = 0; j < pc.transceivers.length; j++) {\n          if (pc.transceivers[j].rejected) {\n            continue;\n          }\n          pc.transceivers[j].iceTransport.addRemoteCandidate({});\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[j] += 'a=end-of-candidates\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n          if (pc.usingBundle) {\n            break;\n          }\n        }\n      } else {\n        var sdpMLineIndex = candidate.sdpMLineIndex;\n        if (candidate.sdpMid) {\n          for (var i = 0; i < pc.transceivers.length; i++) {\n            if (pc.transceivers[i].mid === candidate.sdpMid) {\n              sdpMLineIndex = i;\n              break;\n            }\n          }\n        }\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        if (transceiver) {\n          if (transceiver.rejected) {\n            return resolve();\n          }\n          var cand = Object.keys(candidate.candidate).length > 0 ?\n              SDPUtils.parseCandidate(candidate.candidate) : {};\n          // Ignore Chrome's invalid candidates since Edge does not like them.\n          if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n            return resolve();\n          }\n          // Ignore RTCP candidates, we assume RTCP-MUX.\n          if (cand.component && cand.component !== 1) {\n            return resolve();\n          }\n          // when using bundle, avoid adding candidates to the wrong\n          // ice transport. And avoid adding candidates added in the SDP.\n          if (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&\n              transceiver.iceTransport !== pc.transceivers[0].iceTransport)) {\n            if (!maybeAddCandidate(transceiver.iceTransport, cand)) {\n              return reject(makeError('OperationError',\n                  'Can not add ICE candidate'));\n            }\n          }\n\n          // update the remoteDescription.\n          var candidateString = candidate.candidate.trim();\n          if (candidateString.indexOf('a=') === 0) {\n            candidateString = candidateString.substr(2);\n          }\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[sdpMLineIndex] += 'a=' +\n              (cand.type ? candidateString : 'end-of-candidates')\n              + '\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n        } else {\n          return reject(makeError('OperationError',\n              'Can not add ICE candidate'));\n        }\n      }\n      resolve();\n    });\n  };\n\n  RTCPeerConnection.prototype.getStats = function(selector) {\n    if (selector && selector instanceof window.MediaStreamTrack) {\n      var senderOrReceiver = null;\n      this.transceivers.forEach(function(transceiver) {\n        if (transceiver.rtpSender &&\n            transceiver.rtpSender.track === selector) {\n          senderOrReceiver = transceiver.rtpSender;\n        } else if (transceiver.rtpReceiver &&\n            transceiver.rtpReceiver.track === selector) {\n          senderOrReceiver = transceiver.rtpReceiver;\n        }\n      });\n      if (!senderOrReceiver) {\n        throw makeError('InvalidAccessError', 'Invalid selector.');\n      }\n      return senderOrReceiver.getStats();\n    }\n\n    var promises = [];\n    this.transceivers.forEach(function(transceiver) {\n      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n          'dtlsTransport'].forEach(function(method) {\n            if (transceiver[method]) {\n              promises.push(transceiver[method].getStats());\n            }\n          });\n    });\n    return Promise.all(promises).then(function(allStats) {\n      var results = new Map();\n      allStats.forEach(function(stats) {\n        stats.forEach(function(stat) {\n          results.set(stat.id, stat);\n        });\n      });\n      return results;\n    });\n  };\n\n  // fix low-level stat names and return Map instead of object.\n  var ortcObjects = ['RTCRtpSender', 'RTCRtpReceiver', 'RTCIceGatherer',\n    'RTCIceTransport', 'RTCDtlsTransport'];\n  ortcObjects.forEach(function(ortcObjectName) {\n    var obj = window[ortcObjectName];\n    if (obj && obj.prototype && obj.prototype.getStats) {\n      var nativeGetstats = obj.prototype.getStats;\n      obj.prototype.getStats = function() {\n        return nativeGetstats.apply(this)\n        .then(function(nativeStats) {\n          var mapStats = new Map();\n          Object.keys(nativeStats).forEach(function(id) {\n            nativeStats[id].type = fixStatsType(nativeStats[id]);\n            mapStats.set(id, nativeStats[id]);\n          });\n          return mapStats;\n        });\n      };\n    }\n  });\n\n  // legacy callback shims. Should be moved to adapter.js some days.\n  var methods = ['createOffer', 'createAnswer'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[0] === 'function' ||\n          typeof args[1] === 'function') { // legacy\n        return nativeMethod.apply(this, [arguments[2]])\n        .then(function(description) {\n          if (typeof args[0] === 'function') {\n            args[0].apply(null, [description]);\n          }\n        }, function(error) {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  methods = ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function' ||\n          typeof args[2] === 'function') { // legacy\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        }, function(error) {\n          if (typeof args[2] === 'function') {\n            args[2].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  // getStats is special. It doesn't have a spec legacy method yet we support\n  // getStats(something, cb) without error callbacks.\n  ['getStats'].forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function') {\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  return RTCPeerConnection;\n};\n"],"sourceRoot":""}